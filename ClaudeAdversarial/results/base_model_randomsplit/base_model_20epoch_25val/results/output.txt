PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_base.py --epochs 20
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.5

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 20

Adversarial:
  ADVERSARIAL_LAMBDA: 0.1
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: base
  CV_MODE: standard
================================================================================
2025-10-31 03:21:41,935 - INFO - Using device: cuda:0
2025-10-31 03:21:41,937 - INFO - Loading data...
2025-10-31 03:21:41,944 - INFO - Loaded dataset with 560 samples
2025-10-31 03:21:41,944 - INFO - Data split: Train=308, Val=140, Test=112
2025-10-31 03:21:41,944 - INFO - Creating model...
2025-10-31 03:21:41,977 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 03:21:42,126 - INFO - Initialized trainer for base_model
2025-10-31 03:21:42,127 - INFO - Model parameters: 5,136,814
2025-10-31 03:21:42,127 - INFO - Starting training...
2025-10-31 03:21:43,472 - INFO - Starting training for 20 epochs
Epoch 1: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:02<00:00,  7.22it/s, loss=2.66]
2025-10-31 03:21:46,717 - INFO - Epoch 1/20 - Train Loss: 1.4009, Train Acc: 0.1364 | Val Loss: 0.6530, Val Acc: 0.0929
2025-10-31 03:21:46,741 - INFO - ✓ Saved best model (Val Acc: 0.0929)
Epoch 2: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.89it/s, loss=2.04]
2025-10-31 03:21:48,921 - INFO - Epoch 2/20 - Train Loss: 1.1868, Train Acc: 0.2695 | Val Loss: 0.5741, Val Acc: 0.2000
2025-10-31 03:21:48,944 - INFO - ✓ Saved best model (Val Acc: 0.2000)
Epoch 3: 100%|███████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.91it/s, loss=2.2]
2025-10-31 03:21:51,115 - INFO - Epoch 3/20 - Train Loss: 1.0426, Train Acc: 0.3896 | Val Loss: 0.5253, Val Acc: 0.3286
2025-10-31 03:21:51,138 - INFO - ✓ Saved best model (Val Acc: 0.3286)
Epoch 4: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.93it/s, loss=2.26]
2025-10-31 03:21:53,382 - INFO - Epoch 4/20 - Train Loss: 0.9219, Train Acc: 0.4805 | Val Loss: 0.4653, Val Acc: 0.4071
2025-10-31 03:21:53,415 - INFO - ✓ Saved best model (Val Acc: 0.4071)
Epoch 5: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:02<00:00,  9.82it/s, loss=2.13]
2025-10-31 03:21:55,898 - INFO - Epoch 5/20 - Train Loss: 0.7628, Train Acc: 0.5877 | Val Loss: 0.4510, Val Acc: 0.4071
Epoch 6: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:02<00:00,  9.84it/s, loss=1.47]
2025-10-31 03:21:58,398 - INFO - Epoch 6/20 - Train Loss: 0.6436, Train Acc: 0.6591 | Val Loss: 0.4167, Val Acc: 0.4000
Epoch 7: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.27it/s, loss=1.31]
2025-10-31 03:22:00,694 - INFO - Epoch 7/20 - Train Loss: 0.4621, Train Acc: 0.8117 | Val Loss: 0.4141, Val Acc: 0.4429
2025-10-31 03:22:00,719 - INFO - ✓ Saved best model (Val Acc: 0.4429)
Epoch 8: 100%|██████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.92it/s, loss=0.43]
2025-10-31 03:22:02,891 - INFO - Epoch 8/20 - Train Loss: 0.3277, Train Acc: 0.8766 | Val Loss: 0.3733, Val Acc: 0.4786
2025-10-31 03:22:02,914 - INFO - ✓ Saved best model (Val Acc: 0.4786)
Epoch 9: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 11.03it/s, loss=0.522]
2025-10-31 03:22:05,065 - INFO - Epoch 9/20 - Train Loss: 0.2040, Train Acc: 0.9481 | Val Loss: 0.5742, Val Acc: 0.3500
Epoch 10: 100%|████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.92it/s, loss=0.486]
2025-10-31 03:22:07,235 - INFO - Epoch 10/20 - Train Loss: 0.1529, Train Acc: 0.9708 | Val Loss: 0.4674, Val Acc: 0.3929
Epoch 11: 100%|████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.93it/s, loss=0.191]
2025-10-31 03:22:09,405 - INFO - Epoch 11/20 - Train Loss: 0.0797, Train Acc: 0.9870 | Val Loss: 0.4419, Val Acc: 0.4357
Epoch 12: 100%|████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.92it/s, loss=0.125]
2025-10-31 03:22:11,579 - INFO - Epoch 12/20 - Train Loss: 0.0544, Train Acc: 0.9968 | Val Loss: 0.5389, Val Acc: 0.3500
Epoch 13: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.91it/s, loss=0.0693]
2025-10-31 03:22:13,757 - INFO - Epoch 13/20 - Train Loss: 0.0368, Train Acc: 0.9968 | Val Loss: 0.3784, Val Acc: 0.5286
2025-10-31 03:22:13,782 - INFO - ✓ Saved best model (Val Acc: 0.5286)
Epoch 14: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.96it/s, loss=0.0305]
2025-10-31 03:22:15,947 - INFO - Epoch 14/20 - Train Loss: 0.0245, Train Acc: 1.0000 | Val Loss: 0.3831, Val Acc: 0.5143
Epoch 15: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.98it/s, loss=0.0304]
2025-10-31 03:22:18,108 - INFO - Epoch 15/20 - Train Loss: 0.0201, Train Acc: 1.0000 | Val Loss: 0.3759, Val Acc: 0.5143
Epoch 16: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.93it/s, loss=0.0415]
2025-10-31 03:22:20,276 - INFO - Epoch 16/20 - Train Loss: 0.0140, Train Acc: 1.0000 | Val Loss: 0.3725, Val Acc: 0.5071
Epoch 17: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.95it/s, loss=0.0182]
2025-10-31 03:22:22,448 - INFO - Epoch 17/20 - Train Loss: 0.0120, Train Acc: 1.0000 | Val Loss: 0.3615, Val Acc: 0.5786
2025-10-31 03:22:22,469 - INFO - ✓ Saved best model (Val Acc: 0.5786)
Epoch 18: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.93it/s, loss=0.0157]
2025-10-31 03:22:24,633 - INFO - Epoch 18/20 - Train Loss: 0.0106, Train Acc: 1.0000 | Val Loss: 0.3707, Val Acc: 0.5500
Epoch 19: 100%|████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.92it/s, loss=0.065]
2025-10-31 03:22:26,802 - INFO - Epoch 19/20 - Train Loss: 0.0101, Train Acc: 1.0000 | Val Loss: 0.3783, Val Acc: 0.5286
Epoch 20: 100%|███████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 10.90it/s, loss=0.0302]
2025-10-31 03:22:28,978 - INFO - Epoch 20/20 - Train Loss: 0.0104, Train Acc: 1.0000 | Val Loss: 0.3865, Val Acc: 0.4857
2025-10-31 03:22:28,978 - INFO - Training complete! Best Val Acc: 0.5786 at epoch 17
2025-10-31 03:22:28,978 - INFO - Evaluating on test set...
2025-10-31 03:22:29,009 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 18.82it/s]
2025-10-31 03:22:29,389 - INFO - ================================================================================
2025-10-31 03:22:29,389 - INFO - Test Results
2025-10-31 03:22:29,389 - INFO - ================================================================================
2025-10-31 03:22:29,389 - INFO - Accuracy:  0.5536
2025-10-31 03:22:29,389 - INFO - Precision: 0.5969
2025-10-31 03:22:29,389 - INFO - Recall:    0.5536
2025-10-31 03:22:29,389 - INFO - F1-Score:  0.5341
2025-10-31 03:22:29,390 - INFO - ================================================================================
2025-10-31 03:22:29,390 - INFO -
Classification Report:
2025-10-31 03:22:29,390 - INFO -
              precision    recall  f1-score   support

         A02     0.6250    0.8333    0.7143         6
         A03     0.9000    0.9000    0.9000        10
         A04     0.4444    0.5000    0.4706         8
         A05     1.0000    0.1429    0.2500         7
         A13     0.7273    0.8889    0.8000         9
         A14     0.6000    0.2727    0.3750        11
         A17     0.7500    0.7500    0.7500         8
         A18     0.5000    0.8750    0.6364         8
         A19     0.8333    0.6250    0.7143         8
         A20     0.2500    0.6000    0.3529         5
         A21     0.1429    0.1111    0.1250         9
         A22     0.3000    0.5000    0.3750         6
         A23     0.4000    0.1818    0.2500        11
         A27     0.8333    0.8333    0.8333         6

    accuracy                         0.5536       112
   macro avg     0.5933    0.5724    0.5391       112
weighted avg     0.5969    0.5536    0.5341       112

2025-10-31 03:22:29,390 - INFO - Results saved to results\base_model\results\base_model_results.json
2025-10-31 03:22:29,996 - INFO - Confusion matrix saved to results\base_model\results\base_model_confusion_matrix.png
2025-10-31 03:22:30,366 - INFO - Training history saved to results\base_model\results\base_model_training_history.png
2025-10-31 03:22:30,368 - INFO - ✓ Training and evaluation complete!