PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_base.py --epochs 20
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 20

Adversarial:
  ADVERSARIAL_LAMBDA: 0.1
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: base
  CV_MODE: standard
================================================================================
2025-10-31 03:53:03,183 - INFO - Using device: cuda:0
2025-10-31 03:53:03,185 - INFO - Loading data...
2025-10-31 03:53:03,188 - INFO - Loaded dataset with 560 samples
2025-10-31 03:53:03,189 - INFO - Data split: Train=392, Val=112, Test=56
2025-10-31 03:53:03,189 - INFO - Creating model...
2025-10-31 03:53:03,207 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 03:53:03,312 - INFO - Initialized trainer for base_model
2025-10-31 03:53:03,312 - INFO - Model parameters: 5,136,814
2025-10-31 03:53:03,312 - INFO - Starting training...
2025-10-31 03:53:04,393 - INFO - Starting training for 20 epochs
Epoch 1: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00,  9.59it/s, loss=2.32]
2025-10-31 03:53:07,286 - INFO - Epoch 1/20 - Train Loss: 1.8252, Train Acc: 0.1250 | Val Loss: 0.4965, Val Acc: 0.1161
2025-10-31 03:53:07,312 - INFO - ✓ Saved best model (Val Acc: 0.1161)
Epoch 2: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, loss=2.17]
2025-10-31 03:53:09,924 - INFO - Epoch 2/20 - Train Loss: 1.5956, Train Acc: 0.2066 | Val Loss: 0.4369, Val Acc: 0.1964
2025-10-31 03:53:09,948 - INFO - ✓ Saved best model (Val Acc: 0.1964)
Epoch 3: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, loss=1.99]
2025-10-31 03:53:12,549 - INFO - Epoch 3/20 - Train Loss: 1.3978, Train Acc: 0.2934 | Val Loss: 0.3963, Val Acc: 0.3036
2025-10-31 03:53:12,569 - INFO - ✓ Saved best model (Val Acc: 0.3036)
Epoch 4: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, loss=2.36]
2025-10-31 03:53:15,162 - INFO - Epoch 4/20 - Train Loss: 1.2602, Train Acc: 0.4031 | Val Loss: 0.3797, Val Acc: 0.2946
Epoch 5: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, loss=2.01]
2025-10-31 03:53:17,761 - INFO - Epoch 5/20 - Train Loss: 1.1224, Train Acc: 0.4745 | Val Loss: 0.3234, Val Acc: 0.4196
2025-10-31 03:53:17,782 - INFO - ✓ Saved best model (Val Acc: 0.4196)
Epoch 6: 100%|█████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, loss=0.979]
2025-10-31 03:53:20,380 - INFO - Epoch 6/20 - Train Loss: 0.9215, Train Acc: 0.6097 | Val Loss: 0.4460, Val Acc: 0.3125
Epoch 7: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, loss=1.72]
2025-10-31 03:53:22,968 - INFO - Epoch 7/20 - Train Loss: 0.7971, Train Acc: 0.6582 | Val Loss: 0.3084, Val Acc: 0.3750
Epoch 8: 100%|██████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.83it/s, loss=1.63]
2025-10-31 03:53:25,554 - INFO - Epoch 8/20 - Train Loss: 0.5632, Train Acc: 0.7985 | Val Loss: 0.4913, Val Acc: 0.2143
Epoch 9: 100%|█████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, loss=0.596]
2025-10-31 03:53:28,141 - INFO - Epoch 9/20 - Train Loss: 0.4239, Train Acc: 0.8776 | Val Loss: 0.3034, Val Acc: 0.5000
2025-10-31 03:53:28,163 - INFO - ✓ Saved best model (Val Acc: 0.5000)
Epoch 10: 100%|████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.81it/s, loss=0.509]
2025-10-31 03:53:30,747 - INFO - Epoch 10/20 - Train Loss: 0.2489, Train Acc: 0.9464 | Val Loss: 0.2385, Val Acc: 0.5536
2025-10-31 03:53:30,769 - INFO - ✓ Saved best model (Val Acc: 0.5536)
Epoch 11: 100%|████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, loss=0.248]
2025-10-31 03:53:33,357 - INFO - Epoch 11/20 - Train Loss: 0.1751, Train Acc: 0.9643 | Val Loss: 0.2685, Val Acc: 0.4643
Epoch 12: 100%|████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.81it/s, loss=0.162]
2025-10-31 03:53:35,944 - INFO - Epoch 12/20 - Train Loss: 0.1231, Train Acc: 0.9821 | Val Loss: 0.2726, Val Acc: 0.5357
Epoch 13: 100%|███████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, loss=0.0908]
2025-10-31 03:53:38,544 - INFO - Epoch 13/20 - Train Loss: 0.0666, Train Acc: 0.9974 | Val Loss: 0.2874, Val Acc: 0.4911
Epoch 14: 100%|████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.78it/s, loss=0.075]
2025-10-31 03:53:41,130 - INFO - Epoch 14/20 - Train Loss: 0.0521, Train Acc: 0.9974 | Val Loss: 0.2246, Val Acc: 0.6250
2025-10-31 03:53:41,153 - INFO - ✓ Saved best model (Val Acc: 0.6250)
Epoch 15: 100%|████████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, loss=0.213]
2025-10-31 03:53:43,734 - INFO - Epoch 15/20 - Train Loss: 0.0376, Train Acc: 1.0000 | Val Loss: 0.2721, Val Acc: 0.6071
Epoch 16: 100%|███████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.86it/s, loss=0.0632]
2025-10-31 03:53:46,320 - INFO - Epoch 16/20 - Train Loss: 0.0429, Train Acc: 0.9974 | Val Loss: 0.2383, Val Acc: 0.5179
Epoch 17: 100%|███████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.83it/s, loss=0.0299]
2025-10-31 03:53:48,899 - INFO - Epoch 17/20 - Train Loss: 0.0301, Train Acc: 1.0000 | Val Loss: 0.3399, Val Acc: 0.4732
Epoch 18: 100%|███████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.82it/s, loss=0.0339]
2025-10-31 03:53:51,488 - INFO - Epoch 18/20 - Train Loss: 0.0278, Train Acc: 1.0000 | Val Loss: 0.2623, Val Acc: 0.5000
Epoch 19: 100%|███████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.85it/s, loss=0.0413]
2025-10-31 03:53:54,062 - INFO - Epoch 19/20 - Train Loss: 0.0187, Train Acc: 1.0000 | Val Loss: 0.2186, Val Acc: 0.6071
Epoch 20: 100%|███████████████████████████████████████████████████████████| 25/25 [00:02<00:00, 10.83it/s, loss=0.0289]
2025-10-31 03:53:56,648 - INFO - Epoch 20/20 - Train Loss: 0.0182, Train Acc: 1.0000 | Val Loss: 0.2210, Val Acc: 0.5893
2025-10-31 03:53:56,648 - INFO - Training complete! Best Val Acc: 0.6250 at epoch 14
2025-10-31 03:53:56,648 - INFO - Evaluating on test set...
2025-10-31 03:53:56,673 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 28.66it/s]
2025-10-31 03:53:56,819 - INFO - ================================================================================
2025-10-31 03:53:56,819 - INFO - Test Results
2025-10-31 03:53:56,819 - INFO - ================================================================================
2025-10-31 03:53:56,820 - INFO - Accuracy:  0.6964
2025-10-31 03:53:56,820 - INFO - Precision: 0.8179
2025-10-31 03:53:56,820 - INFO - Recall:    0.6964
2025-10-31 03:53:56,820 - INFO - F1-Score:  0.7129
2025-10-31 03:53:56,820 - INFO - ================================================================================
2025-10-31 03:53:56,820 - INFO -
Classification Report:
2025-10-31 03:53:56,820 - INFO -
              precision    recall  f1-score   support

         A02     0.8000    1.0000    0.8889         4
         A03     1.0000    0.8000    0.8889         5
         A04     1.0000    0.5000    0.6667         4
         A05     0.6667    0.5000    0.5714         4
         A13     1.0000    0.6667    0.8000         6
         A14     1.0000    0.6000    0.7500         5
         A17     1.0000    1.0000    1.0000         3
         A18     0.3636    1.0000    0.5333         4
         A19     0.7500    0.6000    0.6667         5
         A20     0.6667    0.5000    0.5714         4
         A21     0.3333    1.0000    0.5000         1
         A22     0.3333    1.0000    0.5000         1
         A23     1.0000    0.5000    0.6667         6
         A27     0.6000    0.7500    0.6667         4

    accuracy                         0.6964        56
   macro avg     0.7510    0.7440    0.6908        56
weighted avg     0.8179    0.6964    0.7129        56

2025-10-31 03:53:56,821 - INFO - Results saved to results\base_model\results\base_model_results.json
2025-10-31 03:53:57,364 - INFO - Confusion matrix saved to results\base_model\results\base_model_confusion_matrix.png
2025-10-31 03:53:57,739 - INFO - Training history saved to results\base_model\results\base_model_training_history.png
2025-10-31 03:53:57,739 - INFO - ✓ Training and evaluation complete!