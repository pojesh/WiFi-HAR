PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_base.py --epochs 30
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 64
  STEP_SIZE: 32

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 30

Adversarial:
  ADVERSARIAL_LAMBDA: 0.05
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: base
  CV_MODE: standard
================================================================================
2025-10-31 14:45:40,545 - INFO - Using device: cuda:0
2025-10-31 14:45:40,578 - INFO - Loading data...
2025-10-31 14:45:40,602 - INFO - Loaded dataset with 1120 samples
2025-10-31 14:45:40,603 - INFO - Data split: Train=784, Val=224, Test=112
2025-10-31 14:45:40,603 - INFO - Creating model...
2025-10-31 14:45:40,643 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 14:45:40,856 - INFO - Initialized trainer for base_model
2025-10-31 14:45:40,856 - INFO - Model parameters: 5,136,814
2025-10-31 14:45:40,857 - INFO - Starting training...
2025-10-31 14:45:47,973 - INFO - Starting training for 30 epochs
Epoch 1: 100%|██████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  6.01it/s, loss=1.98]
2025-10-31 14:45:57,698 - INFO - Epoch 1/30 - Train Loss: 1.7483, Train Acc: 0.1224 | Val Loss: 0.4442, Val Acc: 0.2277
2025-10-31 14:45:57,755 - INFO - ✓ Saved best model (Val Acc: 0.2277)
Epoch 2: 100%|██████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.70it/s, loss=2.03]
2025-10-31 14:46:01,246 - INFO - Epoch 2/30 - Train Loss: 1.4786, Train Acc: 0.2500 | Val Loss: 0.3521, Val Acc: 0.4420
2025-10-31 14:46:01,276 - INFO - ✓ Saved best model (Val Acc: 0.4420)
Epoch 3: 100%|██████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.82it/s, loss=1.62]
2025-10-31 14:46:04,747 - INFO - Epoch 3/30 - Train Loss: 1.2362, Train Acc: 0.3903 | Val Loss: 0.3267, Val Acc: 0.5000
2025-10-31 14:46:04,772 - INFO - ✓ Saved best model (Val Acc: 0.5000)
Epoch 4: 100%|██████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.84it/s, loss=1.65]
2025-10-31 14:46:08,245 - INFO - Epoch 4/30 - Train Loss: 0.9855, Train Acc: 0.5255 | Val Loss: 0.2556, Val Acc: 0.5536
2025-10-31 14:46:08,274 - INFO - ✓ Saved best model (Val Acc: 0.5536)
Epoch 5: 100%|██████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.83it/s, loss=1.19]
2025-10-31 14:46:11,740 - INFO - Epoch 5/30 - Train Loss: 0.8409, Train Acc: 0.5472 | Val Loss: 0.2480, Val Acc: 0.5670
2025-10-31 14:46:11,765 - INFO - ✓ Saved best model (Val Acc: 0.5670)
Epoch 6: 100%|███████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.83it/s, loss=1.1]
2025-10-31 14:46:15,234 - INFO - Epoch 6/30 - Train Loss: 0.6789, Train Acc: 0.6684 | Val Loss: 0.1603, Val Acc: 0.7545
2025-10-31 14:46:15,261 - INFO - ✓ Saved best model (Val Acc: 0.7545)
Epoch 7: 100%|█████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.82it/s, loss=0.669]
2025-10-31 14:46:18,727 - INFO - Epoch 7/30 - Train Loss: 0.5788, Train Acc: 0.7232 | Val Loss: 0.1891, Val Acc: 0.6696
Epoch 8: 100%|█████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.81it/s, loss=0.785]
2025-10-31 14:46:22,193 - INFO - Epoch 8/30 - Train Loss: 0.4934, Train Acc: 0.7832 | Val Loss: 0.1275, Val Acc: 0.7857
2025-10-31 14:46:22,217 - INFO - ✓ Saved best model (Val Acc: 0.7857)
Epoch 9: 100%|██████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.80it/s, loss=0.67]
2025-10-31 14:46:25,689 - INFO - Epoch 9/30 - Train Loss: 0.3958, Train Acc: 0.8367 | Val Loss: 0.1166, Val Acc: 0.8304
2025-10-31 14:46:25,714 - INFO - ✓ Saved best model (Val Acc: 0.8304)
Epoch 10: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.80it/s, loss=0.504]
2025-10-31 14:46:29,182 - INFO - Epoch 10/30 - Train Loss: 0.2946, Train Acc: 0.8673 | Val Loss: 0.1272, Val Acc: 0.7589
Epoch 11: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.88it/s, loss=0.214]
2025-10-31 14:46:32,646 - INFO - Epoch 11/30 - Train Loss: 0.2566, Train Acc: 0.9133 | Val Loss: 0.1296, Val Acc: 0.7946
Epoch 12: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.78it/s, loss=0.282]
2025-10-31 14:46:36,129 - INFO - Epoch 12/30 - Train Loss: 0.2510, Train Acc: 0.8992 | Val Loss: 0.1142, Val Acc: 0.7946
Epoch 13: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.81it/s, loss=0.378]
2025-10-31 14:46:39,606 - INFO - Epoch 13/30 - Train Loss: 0.2631, Train Acc: 0.8827 | Val Loss: 0.1357, Val Acc: 0.8080
Epoch 14: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.72it/s, loss=0.301]
2025-10-31 14:46:43,108 - INFO - Epoch 14/30 - Train Loss: 0.1263, Train Acc: 0.9579 | Val Loss: 0.0348, Val Acc: 0.9420
2025-10-31 14:46:43,132 - INFO - ✓ Saved best model (Val Acc: 0.9420)
Epoch 15: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.85it/s, loss=0.0698]
2025-10-31 14:46:46,597 - INFO - Epoch 15/30 - Train Loss: 0.0657, Train Acc: 0.9885 | Val Loss: 0.0264, Val Acc: 0.9732
2025-10-31 14:46:46,623 - INFO - ✓ Saved best model (Val Acc: 0.9732)
Epoch 16: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.83it/s, loss=0.152]
2025-10-31 14:46:50,085 - INFO - Epoch 16/30 - Train Loss: 0.0420, Train Acc: 0.9949 | Val Loss: 0.0269, Val Acc: 0.9598
Epoch 17: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.86it/s, loss=0.0566]
2025-10-31 14:46:53,554 - INFO - Epoch 17/30 - Train Loss: 0.0600, Train Acc: 0.9923 | Val Loss: 0.0202, Val Acc: 0.9777
2025-10-31 14:46:53,582 - INFO - ✓ Saved best model (Val Acc: 0.9777)
Epoch 18: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.86it/s, loss=0.0276]
2025-10-31 14:46:57,043 - INFO - Epoch 18/30 - Train Loss: 0.0437, Train Acc: 0.9923 | Val Loss: 0.0204, Val Acc: 0.9732
Epoch 19: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.85it/s, loss=0.0278]
2025-10-31 14:47:00,519 - INFO - Epoch 19/30 - Train Loss: 0.0287, Train Acc: 0.9987 | Val Loss: 0.0182, Val Acc: 0.9732
Epoch 20: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.83it/s, loss=0.124]
2025-10-31 14:47:03,989 - INFO - Epoch 20/30 - Train Loss: 0.0243, Train Acc: 0.9987 | Val Loss: 0.0180, Val Acc: 0.9688
Epoch 21: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.85it/s, loss=0.0349]
2025-10-31 14:47:07,454 - INFO - Epoch 21/30 - Train Loss: 0.0238, Train Acc: 0.9987 | Val Loss: 0.0240, Val Acc: 0.9777
Epoch 22: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.87it/s, loss=0.0146]
2025-10-31 14:47:10,922 - INFO - Epoch 22/30 - Train Loss: 0.0315, Train Acc: 0.9923 | Val Loss: 0.0243, Val Acc: 0.9598
Epoch 23: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.89it/s, loss=0.0205]
2025-10-31 14:47:14,376 - INFO - Epoch 23/30 - Train Loss: 0.0191, Train Acc: 1.0000 | Val Loss: 0.0187, Val Acc: 0.9643
Epoch 24: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.92it/s, loss=0.0244]
2025-10-31 14:47:17,834 - INFO - Epoch 24/30 - Train Loss: 0.0181, Train Acc: 0.9987 | Val Loss: 0.0156, Val Acc: 0.9732
Epoch 25: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.92it/s, loss=0.0193]
2025-10-31 14:47:21,294 - INFO - Epoch 25/30 - Train Loss: 0.0185, Train Acc: 1.0000 | Val Loss: 0.0115, Val Acc: 0.9911
2025-10-31 14:47:21,323 - INFO - ✓ Saved best model (Val Acc: 0.9911)
Epoch 26: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.81it/s, loss=0.0176]
2025-10-31 14:47:24,790 - INFO - Epoch 26/30 - Train Loss: 0.0176, Train Acc: 1.0000 | Val Loss: 0.0113, Val Acc: 0.9911
Epoch 27: 100%|████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.90it/s, loss=0.028]
2025-10-31 14:47:28,240 - INFO - Epoch 27/30 - Train Loss: 0.0142, Train Acc: 1.0000 | Val Loss: 0.0104, Val Acc: 0.9911
Epoch 28: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.90it/s, loss=0.0201]
2025-10-31 14:47:31,691 - INFO - Epoch 28/30 - Train Loss: 0.0132, Train Acc: 1.0000 | Val Loss: 0.0124, Val Acc: 0.9777
Epoch 29: 100%|██████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.91it/s, loss=0.00938]
2025-10-31 14:47:35,149 - INFO - Epoch 29/30 - Train Loss: 0.0122, Train Acc: 1.0000 | Val Loss: 0.0112, Val Acc: 0.9911
Epoch 30: 100%|███████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.90it/s, loss=0.0167]
2025-10-31 14:47:38,604 - INFO - Epoch 30/30 - Train Loss: 0.0118, Train Acc: 1.0000 | Val Loss: 0.0115, Val Acc: 0.9777
2025-10-31 14:47:38,604 - INFO - Training complete! Best Val Acc: 0.9911 at epoch 25
2025-10-31 14:47:38,604 - INFO - Evaluating on test set...
2025-10-31 14:47:38,636 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00,  8.61it/s]
2025-10-31 14:47:39,459 - INFO - ================================================================================
2025-10-31 14:47:39,459 - INFO - Test Results
2025-10-31 14:47:39,459 - INFO - ================================================================================
2025-10-31 14:47:39,459 - INFO - Accuracy:  0.9732
2025-10-31 14:47:39,460 - INFO - Precision: 0.9744
2025-10-31 14:47:39,460 - INFO - Recall:    0.9732
2025-10-31 14:47:39,460 - INFO - F1-Score:  0.9735
2025-10-31 14:47:39,460 - INFO - ================================================================================
2025-10-31 14:47:39,460 - INFO -
Classification Report:
2025-10-31 14:47:39,460 - INFO -
              precision    recall  f1-score   support

         A02     1.0000    1.0000    1.0000         6
         A03     1.0000    1.0000    1.0000         3
         A04     1.0000    1.0000    1.0000         6
         A05     1.0000    1.0000    1.0000         8
         A13     1.0000    1.0000    1.0000         5
         A14     1.0000    1.0000    1.0000         8
         A17     1.0000    1.0000    1.0000         6
         A18     1.0000    1.0000    1.0000         9
         A19     1.0000    1.0000    1.0000         7
         A20     1.0000    1.0000    1.0000         5
         A21     1.0000    1.0000    1.0000        12
         A22     0.8000    0.8889    0.8421         9
         A23     0.9333    0.8750    0.9032        16
         A27     1.0000    1.0000    1.0000        12

    accuracy                         0.9732       112
   macro avg     0.9810    0.9831    0.9818       112
weighted avg     0.9744    0.9732    0.9735       112

2025-10-31 14:47:39,462 - INFO - Results saved to results\base_model\results\base_model_results.json
2025-10-31 14:47:40,422 - INFO - Confusion matrix saved to results\base_model\results\base_model_confusion_matrix.png
2025-10-31 14:47:40,797 - INFO - Training history saved to results\base_model\results\base_model_training_history.png
2025-10-31 14:47:40,798 - INFO - ✓ Training and evaluation complete!