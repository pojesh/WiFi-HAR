PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_base.py --epochs 20
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.5

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 20

Adversarial:
  ADVERSARIAL_LAMBDA: 0.1
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: base
  CV_MODE: standard
================================================================================
2025-10-31 03:27:57,847 - INFO - Using device: cuda:0
2025-10-31 03:27:57,849 - INFO - Loading data...
2025-10-31 03:27:57,852 - INFO - Loaded dataset with 560 samples
2025-10-31 03:27:57,853 - INFO - Data split: Train=336, Val=112, Test=112
2025-10-31 03:27:57,853 - INFO - Creating model...
2025-10-31 03:27:57,872 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 03:27:57,981 - INFO - Initialized trainer for base_model
2025-10-31 03:27:57,981 - INFO - Model parameters: 5,136,814
2025-10-31 03:27:57,981 - INFO - Starting training...
2025-10-31 03:27:59,077 - INFO - Starting training for 20 epochs
Epoch 1: 100%|███████████████████████████████████████████████████████████████| 21/21 [00:02<00:00,  9.10it/s, loss=2.4]
2025-10-31 03:28:01,669 - INFO - Epoch 1/20 - Train Loss: 1.5092, Train Acc: 0.1280 | Val Loss: 0.5339, Val Acc: 0.0536
2025-10-31 03:28:01,695 - INFO - ✓ Saved best model (Val Acc: 0.0536)
Epoch 2: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:02<00:00, 10.46it/s, loss=2.22]
2025-10-31 03:28:03,978 - INFO - Epoch 2/20 - Train Loss: 1.2949, Train Acc: 0.2470 | Val Loss: 0.4805, Val Acc: 0.1339
2025-10-31 03:28:04,003 - INFO - ✓ Saved best model (Val Acc: 0.1339)
Epoch 3: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.58it/s, loss=1.82]
2025-10-31 03:28:06,258 - INFO - Epoch 3/20 - Train Loss: 1.1201, Train Acc: 0.3988 | Val Loss: 0.3845, Val Acc: 0.3125
2025-10-31 03:28:06,278 - INFO - ✓ Saved best model (Val Acc: 0.3125)
Epoch 4: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.58it/s, loss=1.46]
2025-10-31 03:28:08,542 - INFO - Epoch 4/20 - Train Loss: 0.9479, Train Acc: 0.5030 | Val Loss: 0.3631, Val Acc: 0.3482
2025-10-31 03:28:08,566 - INFO - ✓ Saved best model (Val Acc: 0.3482)
Epoch 5: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.53it/s, loss=1.35]
2025-10-31 03:28:10,832 - INFO - Epoch 5/20 - Train Loss: 0.7734, Train Acc: 0.6280 | Val Loss: 0.3049, Val Acc: 0.5357
2025-10-31 03:28:10,855 - INFO - ✓ Saved best model (Val Acc: 0.5357)
Epoch 6: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.59it/s, loss=0.743]
2025-10-31 03:28:13,116 - INFO - Epoch 6/20 - Train Loss: 0.5573, Train Acc: 0.7679 | Val Loss: 0.4029, Val Acc: 0.3304
Epoch 7: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.50it/s, loss=0.463]
2025-10-31 03:28:15,392 - INFO - Epoch 7/20 - Train Loss: 0.3847, Train Acc: 0.8661 | Val Loss: 0.4144, Val Acc: 0.2857
Epoch 8: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.58it/s, loss=0.293]
2025-10-31 03:28:17,649 - INFO - Epoch 8/20 - Train Loss: 0.2206, Train Acc: 0.9673 | Val Loss: 0.3021, Val Acc: 0.4732
Epoch 9: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.55it/s, loss=0.111]
2025-10-31 03:28:19,912 - INFO - Epoch 9/20 - Train Loss: 0.1140, Train Acc: 0.9940 | Val Loss: 0.3308, Val Acc: 0.4286
Epoch 10: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.51it/s, loss=0.076]
2025-10-31 03:28:22,181 - INFO - Epoch 10/20 - Train Loss: 0.0617, Train Acc: 0.9970 | Val Loss: 0.3185, Val Acc: 0.4643
Epoch 11: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.58it/s, loss=0.034]
2025-10-31 03:28:24,442 - INFO - Epoch 11/20 - Train Loss: 0.0347, Train Acc: 1.0000 | Val Loss: 0.2938, Val Acc: 0.5089
Epoch 12: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.60it/s, loss=0.0417]
2025-10-31 03:28:26,705 - INFO - Epoch 12/20 - Train Loss: 0.0301, Train Acc: 0.9970 | Val Loss: 0.2445, Val Acc: 0.5714
2025-10-31 03:28:26,729 - INFO - ✓ Saved best model (Val Acc: 0.5714)
Epoch 13: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.57it/s, loss=0.0267]
2025-10-31 03:28:28,986 - INFO - Epoch 13/20 - Train Loss: 0.0275, Train Acc: 1.0000 | Val Loss: 0.2383, Val Acc: 0.5982
2025-10-31 03:28:29,008 - INFO - ✓ Saved best model (Val Acc: 0.5982)
Epoch 14: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.60it/s, loss=0.0234]
2025-10-31 03:28:31,256 - INFO - Epoch 14/20 - Train Loss: 0.0214, Train Acc: 1.0000 | Val Loss: 0.2377, Val Acc: 0.6071
2025-10-31 03:28:31,280 - INFO - ✓ Saved best model (Val Acc: 0.6071)
Epoch 15: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.57it/s, loss=0.0265]
2025-10-31 03:28:33,540 - INFO - Epoch 15/20 - Train Loss: 0.0189, Train Acc: 1.0000 | Val Loss: 0.2357, Val Acc: 0.5893
Epoch 16: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.57it/s, loss=0.0222]
2025-10-31 03:28:35,804 - INFO - Epoch 16/20 - Train Loss: 0.0181, Train Acc: 1.0000 | Val Loss: 0.2385, Val Acc: 0.5804
Epoch 17: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.56it/s, loss=0.012]
2025-10-31 03:28:38,070 - INFO - Epoch 17/20 - Train Loss: 0.0145, Train Acc: 1.0000 | Val Loss: 0.2386, Val Acc: 0.5804
Epoch 18: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.58it/s, loss=0.0248]
2025-10-31 03:28:40,326 - INFO - Epoch 18/20 - Train Loss: 0.0136, Train Acc: 1.0000 | Val Loss: 0.2451, Val Acc: 0.5893
Epoch 19: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.57it/s, loss=0.0206]
2025-10-31 03:28:42,582 - INFO - Epoch 19/20 - Train Loss: 0.0139, Train Acc: 1.0000 | Val Loss: 0.2463, Val Acc: 0.5804
Epoch 20: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.54it/s, loss=0.0158]
2025-10-31 03:28:44,847 - INFO - Epoch 20/20 - Train Loss: 0.0108, Train Acc: 1.0000 | Val Loss: 0.2524, Val Acc: 0.5625
2025-10-31 03:28:44,847 - INFO - Training complete! Best Val Acc: 0.6071 at epoch 14
2025-10-31 03:28:44,848 - INFO - Evaluating on test set...
2025-10-31 03:28:44,873 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 25.23it/s]
2025-10-31 03:28:45,157 - INFO - ================================================================================
2025-10-31 03:28:45,158 - INFO - Test Results
2025-10-31 03:28:45,158 - INFO - ================================================================================
2025-10-31 03:28:45,158 - INFO - Accuracy:  0.5982
2025-10-31 03:28:45,159 - INFO - Precision: 0.6553
2025-10-31 03:28:45,159 - INFO - Recall:    0.5982
2025-10-31 03:28:45,159 - INFO - F1-Score:  0.5953
2025-10-31 03:28:45,159 - INFO - ================================================================================
2025-10-31 03:28:45,159 - INFO -
Classification Report:
2025-10-31 03:28:45,159 - INFO -
              precision    recall  f1-score   support

         A02     0.5556    0.8333    0.6667         6
         A03     0.8889    0.8000    0.8421        10
         A04     0.8571    0.7500    0.8000         8
         A05     0.7500    0.4286    0.5455         7
         A13     0.6667    0.4444    0.5333         9
         A14     0.8333    0.4545    0.5882        11
         A17     0.6667    0.7500    0.7059         8
         A18     0.4375    0.8750    0.5833         8
         A19     0.7500    0.7500    0.7500         8
         A20     0.1429    0.2000    0.1667         5
         A21     0.5000    0.1111    0.1818         9
         A22     0.3077    0.6667    0.4211         6
         A23     0.5455    0.5455    0.5455        11
         A27     1.0000    0.8333    0.9091         6

    accuracy                         0.5982       112
   macro avg     0.6358    0.6030    0.5885       112
weighted avg     0.6553    0.5982    0.5953       112

2025-10-31 03:28:45,160 - INFO - Results saved to results\base_model\results\base_model_results.json
2025-10-31 03:28:45,696 - INFO - Confusion matrix saved to results\base_model\results\base_model_confusion_matrix.png
2025-10-31 03:28:46,061 - INFO - Training history saved to results\base_model\results\base_model_training_history.png
2025-10-31 03:28:46,061 - INFO - ✓ Training and evaluation complete!