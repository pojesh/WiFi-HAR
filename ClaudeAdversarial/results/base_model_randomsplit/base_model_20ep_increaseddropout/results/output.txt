PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_base.py --epochs 20
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 20

Adversarial:
  ADVERSARIAL_LAMBDA: 0.1
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: base
  CV_MODE: standard
================================================================================
2025-10-31 03:44:07,980 - INFO - Using device: cuda:0
2025-10-31 03:44:07,982 - INFO - Loading data...
2025-10-31 03:44:07,985 - INFO - Loaded dataset with 560 samples
2025-10-31 03:44:07,985 - INFO - Data split: Train=336, Val=112, Test=112
2025-10-31 03:44:07,986 - INFO - Creating model...
2025-10-31 03:44:08,004 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 03:44:08,093 - INFO - Initialized trainer for base_model
2025-10-31 03:44:08,093 - INFO - Model parameters: 5,136,814
2025-10-31 03:44:08,093 - INFO - Starting training...
2025-10-31 03:44:09,139 - INFO - Starting training for 20 epochs
Epoch 1: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:02<00:00,  9.17it/s, loss=2.54]
2025-10-31 03:44:11,712 - INFO - Epoch 1/20 - Train Loss: 1.5625, Train Acc: 0.1101 | Val Loss: 0.5268, Val Acc: 0.1339
2025-10-31 03:44:11,740 - INFO - ✓ Saved best model (Val Acc: 0.1339)
Epoch 2: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.58it/s, loss=2.06]
2025-10-31 03:44:14,002 - INFO - Epoch 2/20 - Train Loss: 1.3463, Train Acc: 0.2351 | Val Loss: 0.4766, Val Acc: 0.1607
2025-10-31 03:44:14,029 - INFO - ✓ Saved best model (Val Acc: 0.1607)
Epoch 3: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.65it/s, loss=2.06]
2025-10-31 03:44:16,274 - INFO - Epoch 3/20 - Train Loss: 1.2137, Train Acc: 0.3185 | Val Loss: 0.3997, Val Acc: 0.2946
2025-10-31 03:44:16,295 - INFO - ✓ Saved best model (Val Acc: 0.2946)
Epoch 4: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.56it/s, loss=1.67]
2025-10-31 03:44:18,555 - INFO - Epoch 4/20 - Train Loss: 1.0847, Train Acc: 0.3542 | Val Loss: 0.3528, Val Acc: 0.4286
2025-10-31 03:44:18,577 - INFO - ✓ Saved best model (Val Acc: 0.4286)
Epoch 5: 100%|██████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.64it/s, loss=1.56]
2025-10-31 03:44:20,825 - INFO - Epoch 5/20 - Train Loss: 0.8895, Train Acc: 0.5208 | Val Loss: 0.3915, Val Acc: 0.3304
Epoch 6: 100%|███████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.66it/s, loss=1.3]
2025-10-31 03:44:23,067 - INFO - Epoch 6/20 - Train Loss: 0.7598, Train Acc: 0.6161 | Val Loss: 0.3287, Val Acc: 0.3839
Epoch 7: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.62it/s, loss=0.853]
2025-10-31 03:44:25,328 - INFO - Epoch 7/20 - Train Loss: 0.5858, Train Acc: 0.7470 | Val Loss: 0.3557, Val Acc: 0.3929
Epoch 8: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.57it/s, loss=0.833]
2025-10-31 03:44:27,587 - INFO - Epoch 8/20 - Train Loss: 0.4655, Train Acc: 0.8244 | Val Loss: 0.2815, Val Acc: 0.5000
2025-10-31 03:44:27,611 - INFO - ✓ Saved best model (Val Acc: 0.5000)
Epoch 9: 100%|█████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.59it/s, loss=0.486]
2025-10-31 03:44:29,863 - INFO - Epoch 9/20 - Train Loss: 0.3064, Train Acc: 0.9286 | Val Loss: 0.3233, Val Acc: 0.4554
Epoch 10: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.60it/s, loss=0.305]
2025-10-31 03:44:32,110 - INFO - Epoch 10/20 - Train Loss: 0.1805, Train Acc: 0.9673 | Val Loss: 0.2863, Val Acc: 0.5089
2025-10-31 03:44:32,133 - INFO - ✓ Saved best model (Val Acc: 0.5089)
Epoch 11: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.63it/s, loss=0.0995]
2025-10-31 03:44:34,374 - INFO - Epoch 11/20 - Train Loss: 0.1034, Train Acc: 0.9792 | Val Loss: 0.2196, Val Acc: 0.5893
2025-10-31 03:44:34,395 - INFO - ✓ Saved best model (Val Acc: 0.5893)
Epoch 12: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.62it/s, loss=0.149]
2025-10-31 03:44:36,651 - INFO - Epoch 12/20 - Train Loss: 0.0815, Train Acc: 0.9911 | Val Loss: 0.2423, Val Acc: 0.5804
Epoch 13: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.63it/s, loss=0.193]
2025-10-31 03:44:38,899 - INFO - Epoch 13/20 - Train Loss: 0.0811, Train Acc: 0.9940 | Val Loss: 0.2474, Val Acc: 0.6161
2025-10-31 03:44:38,920 - INFO - ✓ Saved best model (Val Acc: 0.6161)
Epoch 14: 100%|████████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.65it/s, loss=0.109]
2025-10-31 03:44:41,161 - INFO - Epoch 14/20 - Train Loss: 0.0537, Train Acc: 1.0000 | Val Loss: 0.2706, Val Acc: 0.5268
Epoch 15: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.61it/s, loss=0.0411]
2025-10-31 03:44:43,408 - INFO - Epoch 15/20 - Train Loss: 0.0372, Train Acc: 1.0000 | Val Loss: 0.2153, Val Acc: 0.6071
Epoch 16: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.51it/s, loss=0.0227]
2025-10-31 03:44:45,674 - INFO - Epoch 16/20 - Train Loss: 0.0239, Train Acc: 1.0000 | Val Loss: 0.2093, Val Acc: 0.6250
2025-10-31 03:44:45,698 - INFO - ✓ Saved best model (Val Acc: 0.6250)
Epoch 17: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.61it/s, loss=0.0128]
2025-10-31 03:44:47,950 - INFO - Epoch 17/20 - Train Loss: 0.0195, Train Acc: 1.0000 | Val Loss: 0.1988, Val Acc: 0.6518
2025-10-31 03:44:47,973 - INFO - ✓ Saved best model (Val Acc: 0.6518)
Epoch 18: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.69it/s, loss=0.0296]
2025-10-31 03:44:50,208 - INFO - Epoch 18/20 - Train Loss: 0.0167, Train Acc: 1.0000 | Val Loss: 0.2044, Val Acc: 0.6607
2025-10-31 03:44:50,232 - INFO - ✓ Saved best model (Val Acc: 0.6607)
Epoch 19: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.66it/s, loss=0.0369]
2025-10-31 03:44:52,478 - INFO - Epoch 19/20 - Train Loss: 0.0170, Train Acc: 1.0000 | Val Loss: 0.2192, Val Acc: 0.5804
Epoch 20: 100%|███████████████████████████████████████████████████████████| 21/21 [00:01<00:00, 10.61it/s, loss=0.0243]
2025-10-31 03:44:54,726 - INFO - Epoch 20/20 - Train Loss: 0.0139, Train Acc: 1.0000 | Val Loss: 0.2159, Val Acc: 0.6161
2025-10-31 03:44:54,727 - INFO - Training complete! Best Val Acc: 0.6607 at epoch 18
2025-10-31 03:44:54,727 - INFO - Evaluating on test set...
2025-10-31 03:44:54,755 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 26.30it/s]
2025-10-31 03:44:55,028 - INFO - ================================================================================
2025-10-31 03:44:55,029 - INFO - Test Results
2025-10-31 03:44:55,029 - INFO - ================================================================================
2025-10-31 03:44:55,029 - INFO - Accuracy:  0.5982
2025-10-31 03:44:55,029 - INFO - Precision: 0.6212
2025-10-31 03:44:55,029 - INFO - Recall:    0.5982
2025-10-31 03:44:55,029 - INFO - F1-Score:  0.5791
2025-10-31 03:44:55,029 - INFO - ================================================================================
2025-10-31 03:44:55,029 - INFO -
Classification Report:
2025-10-31 03:44:55,030 - INFO -
              precision    recall  f1-score   support

         A02     0.6667    1.0000    0.8000         6
         A03     0.7500    0.9000    0.8182        10
         A04     0.6250    0.6250    0.6250         8
         A05     1.0000    0.4286    0.6000         7
         A13     0.6667    0.6667    0.6667         9
         A14     1.0000    0.4545    0.6250        11
         A17     0.6667    0.7500    0.7059         8
         A18     0.5000    0.8750    0.6364         8
         A19     0.8571    0.7500    0.8000         8
         A20     0.3333    0.4000    0.3636         5
         A21     0.0000    0.0000    0.0000         9
         A22     0.2500    0.6667    0.3636         6
         A23     0.4286    0.2727    0.3333        11
         A27     0.8333    0.8333    0.8333         6

    accuracy                         0.5982       112
   macro avg     0.6127    0.6159    0.5836       112
weighted avg     0.6212    0.5982    0.5791       112

2025-10-31 03:44:55,030 - INFO - Results saved to results\base_model\results\base_model_results.json
2025-10-31 03:44:55,567 - INFO - Confusion matrix saved to results\base_model\results\base_model_confusion_matrix.png
2025-10-31 03:44:55,929 - INFO - Training history saved to results\base_model\results\base_model_training_history.png
2025-10-31 03:44:55,929 - INFO - ✓ Training and evaluation complete!