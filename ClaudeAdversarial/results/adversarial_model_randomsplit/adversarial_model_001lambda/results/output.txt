PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_adversarial.py --epochs 20 --adversarial_lambda 0.01
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 20

Adversarial:
  ADVERSARIAL_LAMBDA: 0.01
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: adversarial
  CV_MODE: standard
================================================================================
2025-10-31 04:19:35,651 - INFO - Using device: cuda:0
2025-10-31 04:19:35,653 - INFO - Loading data...
2025-10-31 04:19:35,656 - INFO - Loaded dataset with 560 samples
2025-10-31 04:19:35,656 - INFO - Data split: Train=392, Val=112, Test=56
2025-10-31 04:19:35,657 - INFO - Creating adversarial model...
2025-10-31 04:19:35,675 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 04:19:35,675 - INFO - Initialized DomainDiscriminator: input=128, hidden=256, domains=10
2025-10-31 04:19:35,675 - INFO - Initialized AdversarialDANN with GRL
2025-10-31 04:19:35,765 - INFO - Initialized adversarial trainer for adversarial_model
2025-10-31 04:19:35,767 - INFO - Model parameters: 5,204,792
2025-10-31 04:19:35,767 - INFO - Adversarial lambda: 0.01
2025-10-31 04:19:35,767 - INFO - Starting adversarial training...
2025-10-31 04:19:36,784 - INFO - Starting adversarial training for 20 epochs
Epoch 1 (α=0.245): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.41it/s, act_loss=2.73, dom_loss=2.47]
2025-10-31 04:19:39,716 - INFO - Epoch 1/20 - Act Loss: 1.7917, Dom Loss: 1.6928 | Act Acc: 0.1556, Dom Acc: 0.1224 | Val Loss: 0.5160, Val Acc: 0.1071
2025-10-31 04:19:39,741 - INFO - ✓ Saved best model (Val Acc: 0.1071)
Epoch 2 (α=0.462): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.69it/s, act_loss=2.27, dom_loss=2.11]
2025-10-31 04:19:42,354 - INFO - Epoch 2/20 - Act Loss: 1.5669, Dom Loss: 1.5629 | Act Acc: 0.2168, Dom Acc: 0.1735 | Val Loss: 0.4332, Val Acc: 0.2232
2025-10-31 04:19:42,377 - INFO - ✓ Saved best model (Val Acc: 0.2232)
Epoch 3 (α=0.635): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=2.21, dom_loss=2.18]
2025-10-31 04:19:44,973 - INFO - Epoch 3/20 - Act Loss: 1.3964, Dom Loss: 1.5369 | Act Acc: 0.3240, Dom Acc: 0.1786 | Val Loss: 0.3792, Val Acc: 0.2679
2025-10-31 04:19:44,997 - INFO - ✓ Saved best model (Val Acc: 0.2679)
Epoch 4 (α=0.762): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=1.66, dom_loss=2.14]
2025-10-31 04:19:47,600 - INFO - Epoch 4/20 - Act Loss: 1.2546, Dom Loss: 1.5157 | Act Acc: 0.4158, Dom Acc: 0.2168 | Val Loss: 0.4353, Val Acc: 0.2857
2025-10-31 04:19:47,623 - INFO - ✓ Saved best model (Val Acc: 0.2857)
Epoch 5 (α=0.848): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=1.73, dom_loss=2.55]
2025-10-31 04:19:50,224 - INFO - Epoch 5/20 - Act Loss: 1.0555, Dom Loss: 1.5082 | Act Acc: 0.5281, Dom Acc: 0.2194 | Val Loss: 0.3853, Val Acc: 0.2946
2025-10-31 04:19:50,246 - INFO - ✓ Saved best model (Val Acc: 0.2946)
Epoch 6 (α=0.905): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, act_loss=1.21, dom_loss=2.38]
2025-10-31 04:19:52,834 - INFO - Epoch 6/20 - Act Loss: 0.8754, Dom Loss: 1.5551 | Act Acc: 0.5969, Dom Acc: 0.1760 | Val Loss: 0.3011, Val Acc: 0.5000
2025-10-31 04:19:52,857 - INFO - ✓ Saved best model (Val Acc: 0.5000)
Epoch 7 (α=0.941): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.859, dom_loss=2.36]
2025-10-31 04:19:55,456 - INFO - Epoch 7/20 - Act Loss: 0.6803, Dom Loss: 1.5429 | Act Acc: 0.7321, Dom Acc: 0.1913 | Val Loss: 0.2685, Val Acc: 0.5089
2025-10-31 04:19:55,478 - INFO - ✓ Saved best model (Val Acc: 0.5089)
Epoch 8 (α=0.964): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.66it/s, act_loss=0.564, dom_loss=2.46]
2025-10-31 04:19:58,098 - INFO - Epoch 8/20 - Act Loss: 0.5114, Dom Loss: 1.5543 | Act Acc: 0.8112, Dom Acc: 0.1760 | Val Loss: 0.3372, Val Acc: 0.4018
Epoch 9 (α=0.978): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.355, dom_loss=2.26]
2025-10-31 04:20:00,699 - INFO - Epoch 9/20 - Act Loss: 0.3721, Dom Loss: 1.5847 | Act Acc: 0.8827, Dom Acc: 0.1607 | Val Loss: 0.2523, Val Acc: 0.5982
2025-10-31 04:20:00,722 - INFO - ✓ Saved best model (Val Acc: 0.5982)
Epoch 10 (α=0.987): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=1.44, dom_loss=2.12]
2025-10-31 04:20:03,313 - INFO - Epoch 10/20 - Act Loss: 0.2518, Dom Loss: 1.5816 | Act Acc: 0.9388, Dom Acc: 0.1811 | Val Loss: 0.2542, Val Acc: 0.5982
Epoch 11 (α=0.992): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, act_loss=0.205, dom_loss=2.22]
2025-10-31 04:20:05,902 - INFO - Epoch 11/20 - Act Loss: 0.1835, Dom Loss: 1.5733 | Act Acc: 0.9770, Dom Acc: 0.1658 | Val Loss: 0.3242, Val Acc: 0.4643
Epoch 12 (α=0.995): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=0.166, dom_loss=2.32]
2025-10-31 04:20:08,501 - INFO - Epoch 12/20 - Act Loss: 0.1534, Dom Loss: 1.5891 | Act Acc: 0.9617, Dom Acc: 0.1199 | Val Loss: 0.2758, Val Acc: 0.4911
Epoch 13 (α=0.997): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.327, dom_loss=2.53]
2025-10-31 04:20:11,098 - INFO - Epoch 13/20 - Act Loss: 0.1280, Dom Loss: 1.6005 | Act Acc: 0.9719, Dom Acc: 0.1531 | Val Loss: 0.2265, Val Acc: 0.6071
2025-10-31 04:20:11,122 - INFO - ✓ Saved best model (Val Acc: 0.6071)
Epoch 14 (α=0.998): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.70it/s, act_loss=0.142, dom_loss=2.13]
2025-10-31 04:20:13,726 - INFO - Epoch 14/20 - Act Loss: 0.0790, Dom Loss: 1.6087 | Act Acc: 0.9949, Dom Acc: 0.1633 | Val Loss: 0.2824, Val Acc: 0.4911
Epoch 15 (α=0.999): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0297, dom_loss=2.3]
2025-10-31 04:20:16,323 - INFO - Epoch 15/20 - Act Loss: 0.0512, Dom Loss: 1.5720 | Act Acc: 0.9974, Dom Acc: 0.1837 | Val Loss: 0.2193, Val Acc: 0.6250
2025-10-31 04:20:16,345 - INFO - ✓ Saved best model (Val Acc: 0.6250)
Epoch 16 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, act_loss=0.0401, dom_loss=2.22]
2025-10-31 04:20:18,932 - INFO - Epoch 16/20 - Act Loss: 0.0390, Dom Loss: 1.5836 | Act Acc: 0.9974, Dom Acc: 0.1633 | Val Loss: 0.2497, Val Acc: 0.5446
Epoch 17 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.72it/s, act_loss=0.0588, dom_loss=2.04]
2025-10-31 04:20:21,541 - INFO - Epoch 17/20 - Act Loss: 0.0287, Dom Loss: 1.5817 | Act Acc: 1.0000, Dom Acc: 0.1658 | Val Loss: 0.2145, Val Acc: 0.6429
2025-10-31 04:20:21,564 - INFO - ✓ Saved best model (Val Acc: 0.6429)
Epoch 18 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=0.0492, dom_loss=2.56]
2025-10-31 04:20:24,160 - INFO - Epoch 18/20 - Act Loss: 0.0216, Dom Loss: 1.5937 | Act Acc: 1.0000, Dom Acc: 0.1429 | Val Loss: 0.1876, Val Acc: 0.6786
2025-10-31 04:20:24,184 - INFO - ✓ Saved best model (Val Acc: 0.6786)
Epoch 19 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, act_loss=0.0257, dom_loss=2.19]
2025-10-31 04:20:26,772 - INFO - Epoch 19/20 - Act Loss: 0.0176, Dom Loss: 1.5918 | Act Acc: 1.0000, Dom Acc: 0.1607 | Val Loss: 0.1851, Val Acc: 0.6518
Epoch 20 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0269, dom_loss=2.26]
2025-10-31 04:20:29,373 - INFO - Epoch 20/20 - Act Loss: 0.0173, Dom Loss: 1.5977 | Act Acc: 1.0000, Dom Acc: 0.1454 | Val Loss: 0.1949, Val Acc: 0.6429
2025-10-31 04:20:29,373 - INFO - Training complete! Best Val Acc: 0.6786 at epoch 18
2025-10-31 04:20:29,374 - INFO - Evaluating on test set...
2025-10-31 04:20:29,400 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 28.86it/s]
2025-10-31 04:20:29,547 - INFO - ================================================================================
2025-10-31 04:20:29,547 - INFO - Test Results (Adversarial Model)
2025-10-31 04:20:29,547 - INFO - ================================================================================
2025-10-31 04:20:29,548 - INFO - Accuracy:  0.7143
2025-10-31 04:20:29,548 - INFO - Precision: 0.7580
2025-10-31 04:20:29,548 - INFO - Recall:    0.7143
2025-10-31 04:20:29,548 - INFO - F1-Score:  0.7006
2025-10-31 04:20:29,548 - INFO - ================================================================================
2025-10-31 04:20:29,549 - INFO -
Classification Report:
2025-10-31 04:20:29,549 - INFO -
              precision    recall  f1-score   support

         A02     0.6667    1.0000    0.8000         4
         A03     0.8000    0.8000    0.8000         5
         A04     1.0000    0.2500    0.4000         4
         A05     0.7500    0.7500    0.7500         4
         A13     0.7500    0.5000    0.6000         6
         A14     0.7500    0.6000    0.6667         5
         A17     1.0000    1.0000    1.0000         3
         A18     0.5000    1.0000    0.6667         4
         A19     0.8000    0.8000    0.8000         5
         A20     0.3333    0.2500    0.2857         4
         A21     0.5000    1.0000    0.6667         1
         A22     0.5000    1.0000    0.6667         1
         A23     1.0000    0.6667    0.8000         6
         A27     0.8000    1.0000    0.8889         4

    accuracy                         0.7143        56
   macro avg     0.7250    0.7583    0.6994        56
weighted avg     0.7580    0.7143    0.7006        56

2025-10-31 04:20:29,550 - INFO - Results saved to results\adversarial_model\results\adversarial_model_results.json
2025-10-31 04:20:30,091 - INFO - Confusion matrix saved to results\adversarial_model\results\adversarial_model_confusion_matrix.png
2025-10-31 04:20:30,837 - INFO - Training history saved to results\adversarial_model\results\adversarial_model_training_history.png
2025-10-31 04:20:30,838 - INFO - ✓ Adversarial training and evaluation complete!