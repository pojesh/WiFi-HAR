PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_adversarial.py --epochs 30 --adversarial_lambda 0.01
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 30

Adversarial:
  ADVERSARIAL_LAMBDA: 0.01
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: adversarial
  CV_MODE: standard
================================================================================
2025-10-31 04:28:47,543 - INFO - Using device: cuda:0
2025-10-31 04:28:47,547 - INFO - Loading data...
2025-10-31 04:28:47,553 - INFO - Loaded dataset with 560 samples
2025-10-31 04:28:47,554 - INFO - Data split: Train=392, Val=112, Test=56
2025-10-31 04:28:47,554 - INFO - Creating adversarial model...
2025-10-31 04:28:47,583 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 04:28:47,584 - INFO - Initialized DomainDiscriminator: input=128, hidden=256, domains=10
2025-10-31 04:28:47,585 - INFO - Initialized AdversarialDANN with GRL
2025-10-31 04:28:47,703 - INFO - Initialized adversarial trainer for adversarial_model
2025-10-31 04:28:47,704 - INFO - Model parameters: 5,204,792
2025-10-31 04:28:47,705 - INFO - Adversarial lambda: 0.01
2025-10-31 04:28:47,705 - INFO - Starting adversarial training...
2025-10-31 04:28:49,632 - INFO - Starting adversarial training for 30 epochs
Epoch 1 (α=0.165): 100%|█████████████████████████████████| 25/25 [00:03<00:00,  8.05it/s, act_loss=2.76, dom_loss=2.45]
2025-10-31 04:28:53,111 - INFO - Epoch 1/30 - Act Loss: 1.7929, Dom Loss: 1.6944 | Act Acc: 0.1480, Dom Acc: 0.1122 | Val Loss: 0.5154, Val Acc: 0.1071
2025-10-31 04:28:53,154 - INFO - ✓ Saved best model (Val Acc: 0.1071)
Epoch 2 (α=0.322): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.32it/s, act_loss=2.25, dom_loss=2.12]
2025-10-31 04:28:56,206 - INFO - Epoch 2/30 - Act Loss: 1.5666, Dom Loss: 1.5625 | Act Acc: 0.2168, Dom Acc: 0.1709 | Val Loss: 0.4318, Val Acc: 0.2232
2025-10-31 04:28:56,239 - INFO - ✓ Saved best model (Val Acc: 0.2232)
Epoch 3 (α=0.462): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.37it/s, act_loss=2.21, dom_loss=2.09]
2025-10-31 04:28:59,249 - INFO - Epoch 3/30 - Act Loss: 1.3984, Dom Loss: 1.5335 | Act Acc: 0.3163, Dom Acc: 0.1862 | Val Loss: 0.3792, Val Acc: 0.2500
2025-10-31 04:28:59,288 - INFO - ✓ Saved best model (Val Acc: 0.2500)
Epoch 4 (α=0.583): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.45it/s, act_loss=1.64, dom_loss=2.05]
2025-10-31 04:29:02,277 - INFO - Epoch 4/30 - Act Loss: 1.2600, Dom Loss: 1.5059 | Act Acc: 0.4107, Dom Acc: 0.2143 | Val Loss: 0.4316, Val Acc: 0.2679
2025-10-31 04:29:02,313 - INFO - ✓ Saved best model (Val Acc: 0.2679)
Epoch 5 (α=0.682): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.55it/s, act_loss=1.57, dom_loss=2.59]
2025-10-31 04:29:05,321 - INFO - Epoch 5/30 - Act Loss: 1.0660, Dom Loss: 1.5055 | Act Acc: 0.5051, Dom Acc: 0.2168 | Val Loss: 0.3597, Val Acc: 0.3482
2025-10-31 04:29:05,362 - INFO - ✓ Saved best model (Val Acc: 0.3482)
Epoch 6 (α=0.762): 100%|██████████████████████████████████| 25/25 [00:02<00:00,  9.51it/s, act_loss=1.21, dom_loss=2.5]
2025-10-31 04:29:08,367 - INFO - Epoch 6/30 - Act Loss: 0.8455, Dom Loss: 1.5594 | Act Acc: 0.6301, Dom Acc: 0.1760 | Val Loss: 0.2991, Val Acc: 0.5268
2025-10-31 04:29:08,410 - INFO - ✓ Saved best model (Val Acc: 0.5268)
Epoch 7 (α=0.823): 100%|████████████████████████████████| 25/25 [00:02<00:00,  9.60it/s, act_loss=0.906, dom_loss=2.32]
2025-10-31 04:29:11,361 - INFO - Epoch 7/30 - Act Loss: 0.7085, Dom Loss: 1.5479 | Act Acc: 0.7143, Dom Acc: 0.2168 | Val Loss: 0.2762, Val Acc: 0.4732
Epoch 8 (α=0.870): 100%|████████████████████████████████| 25/25 [00:02<00:00,  9.57it/s, act_loss=0.414, dom_loss=2.59]
2025-10-31 04:29:14,339 - INFO - Epoch 8/30 - Act Loss: 0.5314, Dom Loss: 1.5576 | Act Acc: 0.8189, Dom Acc: 0.1760 | Val Loss: 0.3156, Val Acc: 0.4196
Epoch 9 (α=0.905): 100%|████████████████████████████████| 25/25 [00:02<00:00,  9.57it/s, act_loss=0.322, dom_loss=2.18]
2025-10-31 04:29:17,304 - INFO - Epoch 9/30 - Act Loss: 0.3805, Dom Loss: 1.5718 | Act Acc: 0.8827, Dom Acc: 0.1811 | Val Loss: 0.3382, Val Acc: 0.3929
Epoch 10 (α=0.931): 100%|████████████████████████████████| 25/25 [00:02<00:00,  9.51it/s, act_loss=0.944, dom_loss=2.1]
2025-10-31 04:29:20,303 - INFO - Epoch 10/30 - Act Loss: 0.2678, Dom Loss: 1.5749 | Act Acc: 0.9413, Dom Acc: 0.1709 | Val Loss: 0.2599, Val Acc: 0.6071
2025-10-31 04:29:20,335 - INFO - ✓ Saved best model (Val Acc: 0.6071)
Epoch 11 (α=0.950): 100%|███████████████████████████████| 25/25 [00:02<00:00,  9.53it/s, act_loss=0.335, dom_loss=2.15]
2025-10-31 04:29:23,317 - INFO - Epoch 11/30 - Act Loss: 0.1756, Dom Loss: 1.6046 | Act Acc: 0.9821, Dom Acc: 0.1607 | Val Loss: 0.3323, Val Acc: 0.5000
Epoch 12 (α=0.964): 100%|███████████████████████████████| 25/25 [00:02<00:00,  9.58it/s, act_loss=0.191, dom_loss=2.16]
2025-10-31 04:29:26,263 - INFO - Epoch 12/30 - Act Loss: 0.1301, Dom Loss: 1.5937 | Act Acc: 0.9770, Dom Acc: 0.1276 | Val Loss: 0.2991, Val Acc: 0.4732
Epoch 13 (α=0.974): 100%|███████████████████████████████| 25/25 [00:02<00:00,  9.44it/s, act_loss=0.199, dom_loss=2.68]
2025-10-31 04:29:29,261 - INFO - Epoch 13/30 - Act Loss: 0.1131, Dom Loss: 1.6424 | Act Acc: 0.9796, Dom Acc: 0.1327 | Val Loss: 0.4650, Val Acc: 0.3304
Epoch 14 (α=0.981): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.67it/s, act_loss=0.0887, dom_loss=2.15]
2025-10-31 04:29:32,192 - INFO - Epoch 14/30 - Act Loss: 0.0881, Dom Loss: 1.5978 | Act Acc: 0.9872, Dom Acc: 0.1429 | Val Loss: 0.2096, Val Acc: 0.6339
2025-10-31 04:29:32,223 - INFO - ✓ Saved best model (Val Acc: 0.6339)
Epoch 15 (α=0.987): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.56it/s, act_loss=0.0342, dom_loss=2.24]
2025-10-31 04:29:35,227 - INFO - Epoch 15/30 - Act Loss: 0.0459, Dom Loss: 1.5835 | Act Acc: 1.0000, Dom Acc: 0.1505 | Val Loss: 0.2113, Val Acc: 0.6161
Epoch 16 (α=0.990): 100%|███████████████████████████████| 25/25 [00:02<00:00,  9.56it/s, act_loss=0.032, dom_loss=2.26]
2025-10-31 04:29:38,201 - INFO - Epoch 16/30 - Act Loss: 0.0348, Dom Loss: 1.5828 | Act Acc: 1.0000, Dom Acc: 0.1607 | Val Loss: 0.2419, Val Acc: 0.5804
Epoch 17 (α=0.993): 100%|███████████████████████████████| 25/25 [00:02<00:00,  9.53it/s, act_loss=0.115, dom_loss=2.23]
2025-10-31 04:29:41,162 - INFO - Epoch 17/30 - Act Loss: 0.0340, Dom Loss: 1.5831 | Act Acc: 1.0000, Dom Acc: 0.1505 | Val Loss: 0.2330, Val Acc: 0.6071
Epoch 18 (α=0.995): 100%|████████████████████████████████| 25/25 [00:02<00:00,  9.54it/s, act_loss=0.057, dom_loss=2.4]
2025-10-31 04:29:44,133 - INFO - Epoch 18/30 - Act Loss: 0.0307, Dom Loss: 1.5821 | Act Acc: 0.9974, Dom Acc: 0.1709 | Val Loss: 0.2742, Val Acc: 0.5268
Epoch 19 (α=0.996): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.51it/s, act_loss=0.0327, dom_loss=2.27]
2025-10-31 04:29:47,099 - INFO - Epoch 19/30 - Act Loss: 0.0248, Dom Loss: 1.5887 | Act Acc: 0.9974, Dom Acc: 0.1505 | Val Loss: 0.2070, Val Acc: 0.6607
2025-10-31 04:29:47,136 - INFO - ✓ Saved best model (Val Acc: 0.6607)
Epoch 20 (α=0.997): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.57it/s, act_loss=0.0189, dom_loss=2.25]
2025-10-31 04:29:50,101 - INFO - Epoch 20/30 - Act Loss: 0.0211, Dom Loss: 1.5802 | Act Acc: 1.0000, Dom Acc: 0.1709 | Val Loss: 0.2054, Val Acc: 0.6429
Epoch 21 (α=0.998): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.42it/s, act_loss=0.0218, dom_loss=2.26]
2025-10-31 04:29:53,085 - INFO - Epoch 21/30 - Act Loss: 0.0188, Dom Loss: 1.5662 | Act Acc: 1.0000, Dom Acc: 0.1556 | Val Loss: 0.2004, Val Acc: 0.6607
Epoch 22 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.59it/s, act_loss=0.0207, dom_loss=2.49]
2025-10-31 04:29:56,057 - INFO - Epoch 22/30 - Act Loss: 0.0159, Dom Loss: 1.5933 | Act Acc: 1.0000, Dom Acc: 0.1735 | Val Loss: 0.1977, Val Acc: 0.6250
Epoch 23 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.44it/s, act_loss=0.0269, dom_loss=2.25]
2025-10-31 04:29:59,073 - INFO - Epoch 23/30 - Act Loss: 0.0149, Dom Loss: 1.5950 | Act Acc: 1.0000, Dom Acc: 0.1250 | Val Loss: 0.1957, Val Acc: 0.6607
Epoch 24 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.55it/s, act_loss=0.0192, dom_loss=2.16]
2025-10-31 04:30:02,041 - INFO - Epoch 24/30 - Act Loss: 0.0152, Dom Loss: 1.6011 | Act Acc: 1.0000, Dom Acc: 0.1352 | Val Loss: 0.2030, Val Acc: 0.6250
Epoch 25 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.56it/s, act_loss=0.0172, dom_loss=2.35]
2025-10-31 04:30:05,029 - INFO - Epoch 25/30 - Act Loss: 0.0140, Dom Loss: 1.5936 | Act Acc: 1.0000, Dom Acc: 0.1301 | Val Loss: 0.2000, Val Acc: 0.6429
Epoch 26 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.34it/s, act_loss=0.0392, dom_loss=2.56]
2025-10-31 04:30:08,061 - INFO - Epoch 26/30 - Act Loss: 0.0134, Dom Loss: 1.5574 | Act Acc: 1.0000, Dom Acc: 0.1454 | Val Loss: 0.1973, Val Acc: 0.6429
Epoch 27 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00,  9.35it/s, act_loss=0.034, dom_loss=2.15]
2025-10-31 04:30:11,118 - INFO - Epoch 27/30 - Act Loss: 0.0118, Dom Loss: 1.5637 | Act Acc: 1.0000, Dom Acc: 0.1658 | Val Loss: 0.2045, Val Acc: 0.6339
Epoch 28 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.05it/s, act_loss=0.0267, dom_loss=2.09]
2025-10-31 04:30:14,263 - INFO - Epoch 28/30 - Act Loss: 0.0140, Dom Loss: 1.5858 | Act Acc: 1.0000, Dom Acc: 0.1429 | Val Loss: 0.2019, Val Acc: 0.6339
Epoch 29 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.30it/s, act_loss=0.0302, dom_loss=2.44]
2025-10-31 04:30:17,359 - INFO - Epoch 29/30 - Act Loss: 0.0132, Dom Loss: 1.5675 | Act Acc: 1.0000, Dom Acc: 0.1505 | Val Loss: 0.2010, Val Acc: 0.6518
Epoch 30 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00,  9.45it/s, act_loss=0.0379, dom_loss=2.33]
2025-10-31 04:30:20,355 - INFO - Epoch 30/30 - Act Loss: 0.0120, Dom Loss: 1.5695 | Act Acc: 1.0000, Dom Acc: 0.1760 | Val Loss: 0.1963, Val Acc: 0.6518
2025-10-31 04:30:20,355 - INFO - Training complete! Best Val Acc: 0.6607 at epoch 19
2025-10-31 04:30:20,356 - INFO - Evaluating on test set...
2025-10-31 04:30:20,404 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 21.44it/s]
2025-10-31 04:30:20,601 - INFO - ================================================================================
2025-10-31 04:30:20,602 - INFO - Test Results (Adversarial Model)
2025-10-31 04:30:20,602 - INFO - ================================================================================
2025-10-31 04:30:20,602 - INFO - Accuracy:  0.7500
2025-10-31 04:30:20,602 - INFO - Precision: 0.7979
2025-10-31 04:30:20,602 - INFO - Recall:    0.7500
2025-10-31 04:30:20,602 - INFO - F1-Score:  0.7290
2025-10-31 04:30:20,602 - INFO - ================================================================================
2025-10-31 04:30:20,602 - INFO -
Classification Report:
2025-10-31 04:30:20,602 - INFO -
              precision    recall  f1-score   support

         A02     0.5714    1.0000    0.7273         4
         A03     1.0000    0.8000    0.8889         5
         A04     1.0000    0.2500    0.4000         4
         A05     0.7500    0.7500    0.7500         4
         A13     0.8000    0.6667    0.7273         6
         A14     1.0000    0.4000    0.5714         5
         A17     1.0000    1.0000    1.0000         3
         A18     0.5714    1.0000    0.7273         4
         A19     0.8000    0.8000    0.8000         5
         A20     0.5000    0.2500    0.3333         4
         A21     1.0000    1.0000    1.0000         1
         A22     0.5000    1.0000    0.6667         1
         A23     0.8571    1.0000    0.9231         6
         A27     0.6667    1.0000    0.8000         4

    accuracy                         0.7500        56
   macro avg     0.7869    0.7798    0.7368        56
weighted avg     0.7979    0.7500    0.7290        56

2025-10-31 04:30:20,604 - INFO - Results saved to results\adversarial_model\results\adversarial_model_results.json
2025-10-31 04:30:21,691 - INFO - Confusion matrix saved to results\adversarial_model\results\adversarial_model_confusion_matrix.png
2025-10-31 04:30:23,273 - INFO - Training history saved to results\adversarial_model\results\adversarial_model_training_history.png
2025-10-31 04:30:23,274 - INFO - ✓ Adversarial training and evaluation complete!