PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_adversarial.py --epochs 20 --adversarial_lambda 0.05
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 20

Adversarial:
  ADVERSARIAL_LAMBDA: 0.05
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: adversarial
  CV_MODE: standard
================================================================================
2025-10-31 04:14:08,855 - INFO - Using device: cuda:0
2025-10-31 04:14:08,857 - INFO - Loading data...
2025-10-31 04:14:08,860 - INFO - Loaded dataset with 560 samples
2025-10-31 04:14:08,860 - INFO - Data split: Train=392, Val=112, Test=56
2025-10-31 04:14:08,861 - INFO - Creating adversarial model...
2025-10-31 04:14:08,879 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 04:14:08,879 - INFO - Initialized DomainDiscriminator: input=128, hidden=256, domains=10
2025-10-31 04:14:08,879 - INFO - Initialized AdversarialDANN with GRL
2025-10-31 04:14:08,957 - INFO - Initialized adversarial trainer for adversarial_model
2025-10-31 04:14:08,958 - INFO - Model parameters: 5,204,792
2025-10-31 04:14:08,958 - INFO - Adversarial lambda: 0.05
2025-10-31 04:14:08,959 - INFO - Starting adversarial training...
2025-10-31 04:14:10,058 - INFO - Starting adversarial training for 20 epochs
Epoch 1 (α=0.245): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.26it/s, act_loss=2.77, dom_loss=2.47]
2025-10-31 04:14:13,040 - INFO - Epoch 1/20 - Act Loss: 1.7904, Dom Loss: 1.6937 | Act Acc: 0.1480, Dom Acc: 0.1224 | Val Loss: 0.5159, Val Acc: 0.1161
2025-10-31 04:14:13,102 - INFO - ✓ Saved best model (Val Acc: 0.1161)
Epoch 2 (α=0.462): 100%|██████████████████████████████████| 25/25 [00:02<00:00, 10.36it/s, act_loss=2.18, dom_loss=2.1]
2025-10-31 04:14:15,813 - INFO - Epoch 2/20 - Act Loss: 1.5615, Dom Loss: 1.5861 | Act Acc: 0.2041, Dom Acc: 0.1913 | Val Loss: 0.4340, Val Acc: 0.2143
2025-10-31 04:14:15,836 - INFO - ✓ Saved best model (Val Acc: 0.2143)
Epoch 3 (α=0.635): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.89it/s, act_loss=2.28, dom_loss=2.25]
2025-10-31 04:14:18,651 - INFO - Epoch 3/20 - Act Loss: 1.3943, Dom Loss: 1.5620 | Act Acc: 0.3240, Dom Acc: 0.1811 | Val Loss: 0.3821, Val Acc: 0.2679
2025-10-31 04:14:18,692 - INFO - ✓ Saved best model (Val Acc: 0.2679)
Epoch 4 (α=0.762): 100%|██████████████████████████████████| 25/25 [00:02<00:00, 10.59it/s, act_loss=1.54, dom_loss=2.2]
2025-10-31 04:14:21,330 - INFO - Epoch 4/20 - Act Loss: 1.2566, Dom Loss: 1.5261 | Act Acc: 0.4184, Dom Acc: 0.2219 | Val Loss: 0.4274, Val Acc: 0.2857
2025-10-31 04:14:21,355 - INFO - ✓ Saved best model (Val Acc: 0.2857)
Epoch 5 (α=0.848): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.70it/s, act_loss=1.64, dom_loss=2.56]
2025-10-31 04:14:23,966 - INFO - Epoch 5/20 - Act Loss: 1.0755, Dom Loss: 1.5486 | Act Acc: 0.4770, Dom Acc: 0.1939 | Val Loss: 0.3568, Val Acc: 0.3661
2025-10-31 04:14:23,992 - INFO - ✓ Saved best model (Val Acc: 0.3661)
Epoch 6 (α=0.905): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.66it/s, act_loss=1.11, dom_loss=2.62]
2025-10-31 04:14:26,610 - INFO - Epoch 6/20 - Act Loss: 0.8748, Dom Loss: 1.5824 | Act Acc: 0.5689, Dom Acc: 0.1888 | Val Loss: 0.3103, Val Acc: 0.4286
2025-10-31 04:14:26,632 - INFO - ✓ Saved best model (Val Acc: 0.4286)
Epoch 7 (α=0.941): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.947, dom_loss=2.33]
2025-10-31 04:14:29,240 - INFO - Epoch 7/20 - Act Loss: 0.7098, Dom Loss: 1.5630 | Act Acc: 0.6837, Dom Acc: 0.2143 | Val Loss: 0.2861, Val Acc: 0.4821
2025-10-31 04:14:29,262 - INFO - ✓ Saved best model (Val Acc: 0.4821)
Epoch 8 (α=0.964): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.426, dom_loss=2.42]
2025-10-31 04:14:31,858 - INFO - Epoch 8/20 - Act Loss: 0.5363, Dom Loss: 1.5894 | Act Acc: 0.7883, Dom Acc: 0.1684 | Val Loss: 0.4238, Val Acc: 0.3304
Epoch 9 (α=0.978): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.81it/s, act_loss=0.315, dom_loss=2.2]
2025-10-31 04:14:34,447 - INFO - Epoch 9/20 - Act Loss: 0.4009, Dom Loss: 1.6211 | Act Acc: 0.8801, Dom Acc: 0.1480 | Val Loss: 0.3087, Val Acc: 0.4107
Epoch 10 (α=0.987): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, act_loss=1.22, dom_loss=1.99]
2025-10-31 04:14:37,053 - INFO - Epoch 10/20 - Act Loss: 0.2662, Dom Loss: 1.6269 | Act Acc: 0.9413, Dom Acc: 0.1658 | Val Loss: 0.2407, Val Acc: 0.5714
2025-10-31 04:14:37,076 - INFO - ✓ Saved best model (Val Acc: 0.5714)
Epoch 11 (α=0.992): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.225, dom_loss=2.43]
2025-10-31 04:14:39,669 - INFO - Epoch 11/20 - Act Loss: 0.2319, Dom Loss: 1.6499 | Act Acc: 0.9515, Dom Acc: 0.1250 | Val Loss: 0.3286, Val Acc: 0.5089
Epoch 12 (α=0.995): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, act_loss=0.193, dom_loss=2.33]
2025-10-31 04:14:42,253 - INFO - Epoch 12/20 - Act Loss: 0.1644, Dom Loss: 1.6271 | Act Acc: 0.9592, Dom Acc: 0.1276 | Val Loss: 0.2902, Val Acc: 0.4732
Epoch 13 (α=0.997): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.217, dom_loss=2.25]
2025-10-31 04:14:44,857 - INFO - Epoch 13/20 - Act Loss: 0.1243, Dom Loss: 1.6619 | Act Acc: 0.9770, Dom Acc: 0.1301 | Val Loss: 0.2744, Val Acc: 0.5714
Epoch 14 (α=0.998): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.268, dom_loss=2.22]
2025-10-31 04:14:47,451 - INFO - Epoch 14/20 - Act Loss: 0.0747, Dom Loss: 1.6367 | Act Acc: 0.9949, Dom Acc: 0.1301 | Val Loss: 0.2171, Val Acc: 0.5982
2025-10-31 04:14:47,474 - INFO - ✓ Saved best model (Val Acc: 0.5982)
Epoch 15 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.0355, dom_loss=2.31]
2025-10-31 04:14:50,072 - INFO - Epoch 15/20 - Act Loss: 0.0461, Dom Loss: 1.6332 | Act Acc: 0.9974, Dom Acc: 0.1199 | Val Loss: 0.2624, Val Acc: 0.5714
Epoch 16 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.0371, dom_loss=2.44]
2025-10-31 04:14:52,666 - INFO - Epoch 16/20 - Act Loss: 0.0337, Dom Loss: 1.6154 | Act Acc: 1.0000, Dom Acc: 0.1582 | Val Loss: 0.2058, Val Acc: 0.6786
2025-10-31 04:14:52,689 - INFO - ✓ Saved best model (Val Acc: 0.6786)
Epoch 17 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=0.0903, dom_loss=2.4]
2025-10-31 04:14:55,285 - INFO - Epoch 17/20 - Act Loss: 0.0276, Dom Loss: 1.6227 | Act Acc: 1.0000, Dom Acc: 0.1378 | Val Loss: 0.1973, Val Acc: 0.6786
Epoch 18 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0428, dom_loss=2.4]
2025-10-31 04:14:57,875 - INFO - Epoch 18/20 - Act Loss: 0.0214, Dom Loss: 1.6441 | Act Acc: 1.0000, Dom Acc: 0.1173 | Val Loss: 0.1898, Val Acc: 0.6696
Epoch 19 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.72it/s, act_loss=0.026, dom_loss=2.12]
2025-10-31 04:15:00,484 - INFO - Epoch 19/20 - Act Loss: 0.0183, Dom Loss: 1.6326 | Act Acc: 1.0000, Dom Acc: 0.1378 | Val Loss: 0.2001, Val Acc: 0.6964
2025-10-31 04:15:00,505 - INFO - ✓ Saved best model (Val Acc: 0.6964)
Epoch 20 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0317, dom_loss=2.23]
2025-10-31 04:15:03,100 - INFO - Epoch 20/20 - Act Loss: 0.0180, Dom Loss: 1.6149 | Act Acc: 1.0000, Dom Acc: 0.1173 | Val Loss: 0.2068, Val Acc: 0.6964
2025-10-31 04:15:03,100 - INFO - Training complete! Best Val Acc: 0.6964 at epoch 19
2025-10-31 04:15:03,100 - INFO - Evaluating on test set...
2025-10-31 04:15:03,128 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 28.30it/s]
2025-10-31 04:15:03,277 - INFO - ================================================================================
2025-10-31 04:15:03,277 - INFO - Test Results (Adversarial Model)
2025-10-31 04:15:03,277 - INFO - ================================================================================
2025-10-31 04:15:03,277 - INFO - Accuracy:  0.7321
2025-10-31 04:15:03,278 - INFO - Precision: 0.7900
2025-10-31 04:15:03,278 - INFO - Recall:    0.7321
2025-10-31 04:15:03,278 - INFO - F1-Score:  0.7131
2025-10-31 04:15:03,278 - INFO - ================================================================================
2025-10-31 04:15:03,278 - INFO -
Classification Report:
2025-10-31 04:15:03,278 - INFO -
              precision    recall  f1-score   support

         A02     0.6667    1.0000    0.8000         4
         A03     0.8333    1.0000    0.9091         5
         A04     1.0000    0.2500    0.4000         4
         A05     0.7500    0.7500    0.7500         4
         A13     0.7143    0.8333    0.7692         6
         A14     1.0000    0.4000    0.5714         5
         A17     0.7500    1.0000    0.8571         3
         A18     0.5714    1.0000    0.7273         4
         A19     0.7500    0.6000    0.6667         5
         A20     0.5000    0.2500    0.3333         4
         A21     0.5000    1.0000    0.6667         1
         A22     0.3333    1.0000    0.5000         1
         A23     1.0000    0.6667    0.8000         6
         A27     1.0000    1.0000    1.0000         4

    accuracy                         0.7321        56
   macro avg     0.7406    0.7679    0.6965        56
weighted avg     0.7900    0.7321    0.7131        56

2025-10-31 04:15:03,279 - INFO - Results saved to results\adversarial_model\results\adversarial_model_results.json
2025-10-31 04:15:03,802 - INFO - Confusion matrix saved to results\adversarial_model\results\adversarial_model_confusion_matrix.png
2025-10-31 04:15:04,553 - INFO - Training history saved to results\adversarial_model\results\adversarial_model_training_history.png
2025-10-31 04:15:04,553 - INFO - ✓ Adversarial training and evaluation complete!
PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial>