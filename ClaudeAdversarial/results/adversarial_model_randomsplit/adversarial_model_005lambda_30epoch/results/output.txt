PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_adversarial.py --epochs 30 --adversarial_lambda 0.05
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 30

Adversarial:
  ADVERSARIAL_LAMBDA: 0.05
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: adversarial
  CV_MODE: standard
================================================================================
2025-10-31 04:23:24,804 - INFO - Using device: cuda:0
2025-10-31 04:23:24,805 - INFO - Loading data...
2025-10-31 04:23:24,809 - INFO - Loaded dataset with 560 samples
2025-10-31 04:23:24,810 - INFO - Data split: Train=392, Val=112, Test=56
2025-10-31 04:23:24,810 - INFO - Creating adversarial model...
2025-10-31 04:23:24,827 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 04:23:24,827 - INFO - Initialized DomainDiscriminator: input=128, hidden=256, domains=10
2025-10-31 04:23:24,828 - INFO - Initialized AdversarialDANN with GRL
2025-10-31 04:23:24,905 - INFO - Initialized adversarial trainer for adversarial_model
2025-10-31 04:23:24,906 - INFO - Model parameters: 5,204,792
2025-10-31 04:23:24,906 - INFO - Adversarial lambda: 0.05
2025-10-31 04:23:24,906 - INFO - Starting adversarial training...
2025-10-31 04:23:25,913 - INFO - Starting adversarial training for 30 epochs
Epoch 1 (α=0.165): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.39it/s, act_loss=2.77, dom_loss=2.47]
2025-10-31 04:23:28,851 - INFO - Epoch 1/30 - Act Loss: 1.7879, Dom Loss: 1.6906 | Act Acc: 0.1556, Dom Acc: 0.1224 | Val Loss: 0.5196, Val Acc: 0.1071
2025-10-31 04:23:28,877 - INFO - ✓ Saved best model (Val Acc: 0.1071)
Epoch 2 (α=0.322): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.64it/s, act_loss=2.22, dom_loss=2.23]
2025-10-31 04:23:31,502 - INFO - Epoch 2/30 - Act Loss: 1.5612, Dom Loss: 1.5727 | Act Acc: 0.2092, Dom Acc: 0.1709 | Val Loss: 0.4348, Val Acc: 0.2143
2025-10-31 04:23:31,523 - INFO - ✓ Saved best model (Val Acc: 0.2143)
Epoch 3 (α=0.462): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=2.29, dom_loss=2.39]
2025-10-31 04:23:34,120 - INFO - Epoch 3/30 - Act Loss: 1.3932, Dom Loss: 1.5474 | Act Acc: 0.3163, Dom Acc: 0.1837 | Val Loss: 0.3805, Val Acc: 0.2679
2025-10-31 04:23:34,146 - INFO - ✓ Saved best model (Val Acc: 0.2679)
Epoch 4 (α=0.583): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.81it/s, act_loss=1.61, dom_loss=2.24]
2025-10-31 04:23:36,727 - INFO - Epoch 4/30 - Act Loss: 1.2529, Dom Loss: 1.5439 | Act Acc: 0.4056, Dom Acc: 0.2015 | Val Loss: 0.4568, Val Acc: 0.2232
Epoch 5 (α=0.682): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.80it/s, act_loss=1.47, dom_loss=2.34]
2025-10-31 04:23:39,313 - INFO - Epoch 5/30 - Act Loss: 1.0639, Dom Loss: 1.5259 | Act Acc: 0.5051, Dom Acc: 0.1888 | Val Loss: 0.3560, Val Acc: 0.3661
2025-10-31 04:23:39,337 - INFO - ✓ Saved best model (Val Acc: 0.3661)
Epoch 6 (α=0.762): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, act_loss=1.19, dom_loss=2.42]
2025-10-31 04:23:41,926 - INFO - Epoch 6/30 - Act Loss: 0.8603, Dom Loss: 1.5752 | Act Acc: 0.5969, Dom Acc: 0.1862 | Val Loss: 0.2926, Val Acc: 0.5179
2025-10-31 04:23:41,949 - INFO - ✓ Saved best model (Val Acc: 0.5179)
Epoch 7 (α=0.823): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.98, dom_loss=2.27]
2025-10-31 04:23:44,554 - INFO - Epoch 7/30 - Act Loss: 0.6828, Dom Loss: 1.5651 | Act Acc: 0.7245, Dom Acc: 0.2117 | Val Loss: 0.2995, Val Acc: 0.4375
Epoch 8 (α=0.870): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.471, dom_loss=2.52]
2025-10-31 04:23:47,161 - INFO - Epoch 8/30 - Act Loss: 0.5180, Dom Loss: 1.6100 | Act Acc: 0.8061, Dom Acc: 0.1352 | Val Loss: 0.3307, Val Acc: 0.3929
Epoch 9 (α=0.905): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=0.411, dom_loss=2.3]
2025-10-31 04:23:49,756 - INFO - Epoch 9/30 - Act Loss: 0.3839, Dom Loss: 1.6469 | Act Acc: 0.8724, Dom Acc: 0.1250 | Val Loss: 0.3094, Val Acc: 0.4464
Epoch 10 (α=0.931): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=1.07, dom_loss=2.28]
2025-10-31 04:23:52,356 - INFO - Epoch 10/30 - Act Loss: 0.2502, Dom Loss: 1.6459 | Act Acc: 0.9311, Dom Acc: 0.1403 | Val Loss: 0.2681, Val Acc: 0.5893
2025-10-31 04:23:52,378 - INFO - ✓ Saved best model (Val Acc: 0.5893)
Epoch 11 (α=0.950): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, act_loss=0.217, dom_loss=2.15]
2025-10-31 04:23:54,979 - INFO - Epoch 11/30 - Act Loss: 0.2018, Dom Loss: 1.6239 | Act Acc: 0.9566, Dom Acc: 0.1403 | Val Loss: 0.3105, Val Acc: 0.4821
Epoch 12 (α=0.964): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, act_loss=0.19, dom_loss=2.48]
2025-10-31 04:23:57,566 - INFO - Epoch 12/30 - Act Loss: 0.1468, Dom Loss: 1.6487 | Act Acc: 0.9694, Dom Acc: 0.1327 | Val Loss: 0.2716, Val Acc: 0.4911
Epoch 13 (α=0.974): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.206, dom_loss=2.54]
2025-10-31 04:24:00,165 - INFO - Epoch 13/30 - Act Loss: 0.1103, Dom Loss: 1.6647 | Act Acc: 0.9847, Dom Acc: 0.1224 | Val Loss: 0.3799, Val Acc: 0.4375
Epoch 14 (α=0.981): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0997, dom_loss=2.28]
2025-10-31 04:24:02,760 - INFO - Epoch 14/30 - Act Loss: 0.0750, Dom Loss: 1.6411 | Act Acc: 0.9898, Dom Acc: 0.1327 | Val Loss: 0.2672, Val Acc: 0.5536
Epoch 15 (α=0.987): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.0545, dom_loss=2.38]
2025-10-31 04:24:05,357 - INFO - Epoch 15/30 - Act Loss: 0.0568, Dom Loss: 1.6417 | Act Acc: 0.9949, Dom Acc: 0.1250 | Val Loss: 0.2069, Val Acc: 0.6071
2025-10-31 04:24:05,380 - INFO - ✓ Saved best model (Val Acc: 0.6071)
Epoch 16 (α=0.990): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.78it/s, act_loss=0.0605, dom_loss=2.14]
2025-10-31 04:24:07,968 - INFO - Epoch 16/30 - Act Loss: 0.0356, Dom Loss: 1.6256 | Act Acc: 1.0000, Dom Acc: 0.1352 | Val Loss: 0.1955, Val Acc: 0.6339
2025-10-31 04:24:07,993 - INFO - ✓ Saved best model (Val Acc: 0.6339)
Epoch 17 (α=0.993): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, act_loss=0.0803, dom_loss=2.23]
2025-10-31 04:24:10,600 - INFO - Epoch 17/30 - Act Loss: 0.0317, Dom Loss: 1.6328 | Act Acc: 1.0000, Dom Acc: 0.1454 | Val Loss: 0.1885, Val Acc: 0.6607
2025-10-31 04:24:10,626 - INFO - ✓ Saved best model (Val Acc: 0.6607)
Epoch 18 (α=0.995): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, act_loss=0.0667, dom_loss=2.48]
2025-10-31 04:24:13,214 - INFO - Epoch 18/30 - Act Loss: 0.0260, Dom Loss: 1.6271 | Act Acc: 1.0000, Dom Acc: 0.1224 | Val Loss: 0.1890, Val Acc: 0.6518
Epoch 19 (α=0.996): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.0328, dom_loss=2.4]
2025-10-31 04:24:15,819 - INFO - Epoch 19/30 - Act Loss: 0.0224, Dom Loss: 1.6323 | Act Acc: 1.0000, Dom Acc: 0.1531 | Val Loss: 0.1880, Val Acc: 0.6607
Epoch 20 (α=0.997): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.0315, dom_loss=2.33]
2025-10-31 04:24:18,424 - INFO - Epoch 20/30 - Act Loss: 0.0246, Dom Loss: 1.6379 | Act Acc: 1.0000, Dom Acc: 0.1046 | Val Loss: 0.1932, Val Acc: 0.6607
Epoch 21 (α=0.998): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=0.0292, dom_loss=2.23]
2025-10-31 04:24:21,020 - INFO - Epoch 21/30 - Act Loss: 0.0221, Dom Loss: 1.6136 | Act Acc: 1.0000, Dom Acc: 0.1301 | Val Loss: 0.1913, Val Acc: 0.6339
Epoch 22 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.0305, dom_loss=2.57]
2025-10-31 04:24:23,624 - INFO - Epoch 22/30 - Act Loss: 0.0189, Dom Loss: 1.6734 | Act Acc: 1.0000, Dom Acc: 0.1301 | Val Loss: 0.1881, Val Acc: 0.6429
Epoch 23 (α=0.999): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, act_loss=0.036, dom_loss=2.49]
2025-10-31 04:24:26,230 - INFO - Epoch 23/30 - Act Loss: 0.0187, Dom Loss: 1.6564 | Act Acc: 1.0000, Dom Acc: 0.0969 | Val Loss: 0.1855, Val Acc: 0.6429
Epoch 24 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, act_loss=0.0319, dom_loss=2.33]
2025-10-31 04:24:28,846 - INFO - Epoch 24/30 - Act Loss: 0.0196, Dom Loss: 1.6211 | Act Acc: 1.0000, Dom Acc: 0.1148 | Val Loss: 0.1868, Val Acc: 0.6518
Epoch 25 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.81it/s, act_loss=0.0207, dom_loss=2.4]
2025-10-31 04:24:31,431 - INFO - Epoch 25/30 - Act Loss: 0.0176, Dom Loss: 1.6260 | Act Acc: 1.0000, Dom Acc: 0.1224 | Val Loss: 0.1851, Val Acc: 0.6518
Epoch 26 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.0449, dom_loss=2.57]
2025-10-31 04:24:34,035 - INFO - Epoch 26/30 - Act Loss: 0.0167, Dom Loss: 1.6126 | Act Acc: 1.0000, Dom Acc: 0.1352 | Val Loss: 0.1832, Val Acc: 0.6429
Epoch 27 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.0464, dom_loss=2.49]
2025-10-31 04:24:36,639 - INFO - Epoch 27/30 - Act Loss: 0.0149, Dom Loss: 1.6292 | Act Acc: 1.0000, Dom Acc: 0.0995 | Val Loss: 0.1853, Val Acc: 0.6518
Epoch 28 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0252, dom_loss=2.27]
2025-10-31 04:24:39,234 - INFO - Epoch 28/30 - Act Loss: 0.0166, Dom Loss: 1.6463 | Act Acc: 1.0000, Dom Acc: 0.0969 | Val Loss: 0.1850, Val Acc: 0.6696
2025-10-31 04:24:39,259 - INFO - ✓ Saved best model (Val Acc: 0.6696)
Epoch 29 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.72it/s, act_loss=0.0308, dom_loss=2.59]
2025-10-31 04:24:41,864 - INFO - Epoch 29/30 - Act Loss: 0.0164, Dom Loss: 1.6174 | Act Acc: 1.0000, Dom Acc: 0.1403 | Val Loss: 0.1826, Val Acc: 0.6518
Epoch 30 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.72it/s, act_loss=0.0445, dom_loss=2.45]
2025-10-31 04:24:44,467 - INFO - Epoch 30/30 - Act Loss: 0.0156, Dom Loss: 1.6102 | Act Acc: 1.0000, Dom Acc: 0.1403 | Val Loss: 0.1805, Val Acc: 0.6518
2025-10-31 04:24:44,468 - INFO - Training complete! Best Val Acc: 0.6696 at epoch 28
2025-10-31 04:24:44,468 - INFO - Evaluating on test set...
2025-10-31 04:24:44,497 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 28.74it/s]
2025-10-31 04:24:44,644 - INFO - ================================================================================
2025-10-31 04:24:44,645 - INFO - Test Results (Adversarial Model)
2025-10-31 04:24:44,645 - INFO - ================================================================================
2025-10-31 04:24:44,645 - INFO - Accuracy:  0.7321
2025-10-31 04:24:44,645 - INFO - Precision: 0.7746
2025-10-31 04:24:44,645 - INFO - Recall:    0.7321
2025-10-31 04:24:44,645 - INFO - F1-Score:  0.7086
2025-10-31 04:24:44,645 - INFO - ================================================================================
2025-10-31 04:24:44,645 - INFO -
Classification Report:
2025-10-31 04:24:44,646 - INFO -
              precision    recall  f1-score   support

         A02     0.6667    1.0000    0.8000         4
         A03     0.6250    1.0000    0.7692         5
         A04     1.0000    0.2500    0.4000         4
         A05     0.7500    0.7500    0.7500         4
         A13     0.8000    0.6667    0.7273         6
         A14     1.0000    0.4000    0.5714         5
         A17     0.7500    1.0000    0.8571         3
         A18     0.5714    1.0000    0.7273         4
         A19     0.7500    0.6000    0.6667         5
         A20     0.5000    0.2500    0.3333         4
         A21     0.5000    1.0000    0.6667         1
         A22     1.0000    1.0000    1.0000         1
         A23     0.8333    0.8333    0.8333         6
         A27     1.0000    1.0000    1.0000         4

    accuracy                         0.7321        56
   macro avg     0.7676    0.7679    0.7216        56
weighted avg     0.7746    0.7321    0.7086        56

2025-10-31 04:24:44,647 - INFO - Results saved to results\adversarial_model\results\adversarial_model_results.json
2025-10-31 04:24:45,173 - INFO - Confusion matrix saved to results\adversarial_model\results\adversarial_model_confusion_matrix.png
2025-10-31 04:24:45,898 - INFO - Training history saved to results\adversarial_model\results\adversarial_model_training_history.png
2025-10-31 04:24:45,898 - INFO - ✓ Adversarial training and evaluation complete!