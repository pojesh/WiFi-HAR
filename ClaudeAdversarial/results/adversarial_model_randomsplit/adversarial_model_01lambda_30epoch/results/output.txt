PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_adversarial.py --epochs 30 --adversarial_lambda 0.1
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 100
  STEP_SIZE: 50

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 30

Adversarial:
  ADVERSARIAL_LAMBDA: 0.1
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: adversarial
  CV_MODE: standard
================================================================================
2025-10-31 04:34:19,829 - INFO - Using device: cuda:0
2025-10-31 04:34:19,831 - INFO - Loading data...
2025-10-31 04:34:19,834 - INFO - Loaded dataset with 560 samples
2025-10-31 04:34:19,834 - INFO - Data split: Train=392, Val=112, Test=56
2025-10-31 04:34:19,834 - INFO - Creating adversarial model...
2025-10-31 04:34:19,851 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 04:34:19,852 - INFO - Initialized DomainDiscriminator: input=128, hidden=256, domains=10
2025-10-31 04:34:19,853 - INFO - Initialized AdversarialDANN with GRL
2025-10-31 04:34:19,937 - INFO - Initialized adversarial trainer for adversarial_model
2025-10-31 04:34:19,937 - INFO - Model parameters: 5,204,792
2025-10-31 04:34:19,938 - INFO - Adversarial lambda: 0.1
2025-10-31 04:34:19,938 - INFO - Starting adversarial training...
2025-10-31 04:34:20,967 - INFO - Starting adversarial training for 30 epochs
Epoch 1 (α=0.165): 100%|█████████████████████████████████| 25/25 [00:02<00:00,  9.55it/s, act_loss=2.76, dom_loss=2.52]
2025-10-31 04:34:23,866 - INFO - Epoch 1/30 - Act Loss: 1.7890, Dom Loss: 1.7012 | Act Acc: 0.1531, Dom Acc: 0.1097 | Val Loss: 0.5206, Val Acc: 0.1161
2025-10-31 04:34:23,890 - INFO - ✓ Saved best model (Val Acc: 0.1161)
Epoch 2 (α=0.322): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.69it/s, act_loss=2.23, dom_loss=2.08]
2025-10-31 04:34:26,503 - INFO - Epoch 2/30 - Act Loss: 1.5640, Dom Loss: 1.5764 | Act Acc: 0.2041, Dom Acc: 0.1786 | Val Loss: 0.4323, Val Acc: 0.1875
2025-10-31 04:34:26,528 - INFO - ✓ Saved best model (Val Acc: 0.1875)
Epoch 3 (α=0.462): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.69it/s, act_loss=2.18, dom_loss=2.22]
2025-10-31 04:34:29,141 - INFO - Epoch 3/30 - Act Loss: 1.3983, Dom Loss: 1.5419 | Act Acc: 0.3112, Dom Acc: 0.1837 | Val Loss: 0.3770, Val Acc: 0.2768
2025-10-31 04:34:29,164 - INFO - ✓ Saved best model (Val Acc: 0.2768)
Epoch 4 (α=0.583): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=1.64, dom_loss=2.43]
2025-10-31 04:34:31,763 - INFO - Epoch 4/30 - Act Loss: 1.2544, Dom Loss: 1.5331 | Act Acc: 0.4184, Dom Acc: 0.1964 | Val Loss: 0.4476, Val Acc: 0.2857
2025-10-31 04:34:31,786 - INFO - ✓ Saved best model (Val Acc: 0.2857)
Epoch 5 (α=0.682): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=1.48, dom_loss=2.65]
2025-10-31 04:34:34,391 - INFO - Epoch 5/30 - Act Loss: 1.0651, Dom Loss: 1.5678 | Act Acc: 0.5153, Dom Acc: 0.1811 | Val Loss: 0.3483, Val Acc: 0.3929
2025-10-31 04:34:34,414 - INFO - ✓ Saved best model (Val Acc: 0.3929)
Epoch 6 (α=0.762): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=1.16, dom_loss=2.58]
2025-10-31 04:34:37,010 - INFO - Epoch 6/30 - Act Loss: 0.8515, Dom Loss: 1.6021 | Act Acc: 0.6582, Dom Acc: 0.1633 | Val Loss: 0.3036, Val Acc: 0.4732
2025-10-31 04:34:37,032 - INFO - ✓ Saved best model (Val Acc: 0.4732)
Epoch 7 (α=0.823): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.77it/s, act_loss=0.851, dom_loss=2.13]
2025-10-31 04:34:39,626 - INFO - Epoch 7/30 - Act Loss: 0.6790, Dom Loss: 1.6018 | Act Acc: 0.7219, Dom Acc: 0.1735 | Val Loss: 0.2916, Val Acc: 0.4732
Epoch 8 (α=0.870): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.657, dom_loss=2.46]
2025-10-31 04:34:42,226 - INFO - Epoch 8/30 - Act Loss: 0.5064, Dom Loss: 1.6409 | Act Acc: 0.8240, Dom Acc: 0.1276 | Val Loss: 0.5001, Val Acc: 0.2589
Epoch 9 (α=0.905): 100%|█████████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, act_loss=0.36, dom_loss=2.36]
2025-10-31 04:34:44,814 - INFO - Epoch 9/30 - Act Loss: 0.3503, Dom Loss: 1.6448 | Act Acc: 0.8980, Dom Acc: 0.1403 | Val Loss: 0.3033, Val Acc: 0.4821
2025-10-31 04:34:44,839 - INFO - ✓ Saved best model (Val Acc: 0.4821)
Epoch 10 (α=0.931): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.846, dom_loss=2.27]
2025-10-31 04:34:47,443 - INFO - Epoch 10/30 - Act Loss: 0.2472, Dom Loss: 1.6478 | Act Acc: 0.9464, Dom Acc: 0.1250 | Val Loss: 0.3292, Val Acc: 0.4286
Epoch 11 (α=0.950): 100%|████████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.254, dom_loss=2.5]
2025-10-31 04:34:50,051 - INFO - Epoch 11/30 - Act Loss: 0.1643, Dom Loss: 1.6440 | Act Acc: 0.9745, Dom Acc: 0.1301 | Val Loss: 0.2900, Val Acc: 0.5536
2025-10-31 04:34:50,073 - INFO - ✓ Saved best model (Val Acc: 0.5536)
Epoch 12 (α=0.964): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.79it/s, act_loss=0.179, dom_loss=2.39]
2025-10-31 04:34:52,662 - INFO - Epoch 12/30 - Act Loss: 0.1136, Dom Loss: 1.6649 | Act Acc: 0.9949, Dom Acc: 0.1046 | Val Loss: 0.3081, Val Acc: 0.4554
Epoch 13 (α=0.974): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.75it/s, act_loss=0.145, dom_loss=2.59]
2025-10-31 04:34:55,260 - INFO - Epoch 13/30 - Act Loss: 0.0875, Dom Loss: 1.7078 | Act Acc: 0.9898, Dom Acc: 0.1122 | Val Loss: 0.2175, Val Acc: 0.5893
2025-10-31 04:34:55,284 - INFO - ✓ Saved best model (Val Acc: 0.5893)
Epoch 14 (α=0.981): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.72it/s, act_loss=0.168, dom_loss=2.37]
2025-10-31 04:34:57,887 - INFO - Epoch 14/30 - Act Loss: 0.0574, Dom Loss: 1.6658 | Act Acc: 0.9949, Dom Acc: 0.0995 | Val Loss: 0.2395, Val Acc: 0.6518
2025-10-31 04:34:57,908 - INFO - ✓ Saved best model (Val Acc: 0.6518)
Epoch 15 (α=0.987): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.73it/s, act_loss=0.0511, dom_loss=2.27]
2025-10-31 04:35:00,510 - INFO - Epoch 15/30 - Act Loss: 0.0688, Dom Loss: 1.6536 | Act Acc: 0.9847, Dom Acc: 0.1071 | Val Loss: 0.2900, Val Acc: 0.5268
Epoch 16 (α=0.990): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.112, dom_loss=2.38]
2025-10-31 04:35:03,106 - INFO - Epoch 16/30 - Act Loss: 0.0664, Dom Loss: 1.6150 | Act Acc: 0.9872, Dom Acc: 0.1199 | Val Loss: 0.2783, Val Acc: 0.5536
Epoch 17 (α=0.993): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.74it/s, act_loss=0.124, dom_loss=2.49]
2025-10-31 04:35:05,723 - INFO - Epoch 17/30 - Act Loss: 0.0547, Dom Loss: 1.6481 | Act Acc: 0.9949, Dom Acc: 0.1122 | Val Loss: 0.2781, Val Acc: 0.5357
Epoch 18 (α=0.995): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.62it/s, act_loss=0.0414, dom_loss=2.54]
2025-10-31 04:35:08,355 - INFO - Epoch 18/30 - Act Loss: 0.0317, Dom Loss: 1.6655 | Act Acc: 1.0000, Dom Acc: 0.1250 | Val Loss: 0.2175, Val Acc: 0.6339
Epoch 19 (α=0.996): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.65it/s, act_loss=0.0282, dom_loss=2.4]
2025-10-31 04:35:10,985 - INFO - Epoch 19/30 - Act Loss: 0.0222, Dom Loss: 1.6549 | Act Acc: 1.0000, Dom Acc: 0.1224 | Val Loss: 0.2031, Val Acc: 0.6786
2025-10-31 04:35:11,008 - INFO - ✓ Saved best model (Val Acc: 0.6786)
Epoch 20 (α=0.997): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.64it/s, act_loss=0.0319, dom_loss=2.25]
2025-10-31 04:35:13,631 - INFO - Epoch 20/30 - Act Loss: 0.0223, Dom Loss: 1.6263 | Act Acc: 1.0000, Dom Acc: 0.1224 | Val Loss: 0.1864, Val Acc: 0.7054
2025-10-31 04:35:13,654 - INFO - ✓ Saved best model (Val Acc: 0.7054)
Epoch 21 (α=0.998): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.68it/s, act_loss=0.0275, dom_loss=2.5]
2025-10-31 04:35:16,268 - INFO - Epoch 21/30 - Act Loss: 0.0198, Dom Loss: 1.6343 | Act Acc: 1.0000, Dom Acc: 0.1403 | Val Loss: 0.2015, Val Acc: 0.6607
Epoch 22 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.70it/s, act_loss=0.0216, dom_loss=2.53]
2025-10-31 04:35:18,884 - INFO - Epoch 22/30 - Act Loss: 0.0161, Dom Loss: 1.6605 | Act Acc: 1.0000, Dom Acc: 0.1199 | Val Loss: 0.1867, Val Acc: 0.6964
Epoch 23 (α=0.999): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.69it/s, act_loss=0.0216, dom_loss=2.45]
2025-10-31 04:35:21,501 - INFO - Epoch 23/30 - Act Loss: 0.0145, Dom Loss: 1.6509 | Act Acc: 1.0000, Dom Acc: 0.1276 | Val Loss: 0.1825, Val Acc: 0.6964
Epoch 24 (α=0.999): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.68it/s, act_loss=0.018, dom_loss=2.25]
2025-10-31 04:35:24,114 - INFO - Epoch 24/30 - Act Loss: 0.0153, Dom Loss: 1.6377 | Act Acc: 1.0000, Dom Acc: 0.1276 | Val Loss: 0.1846, Val Acc: 0.6786
Epoch 25 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.67it/s, act_loss=0.0146, dom_loss=2.3]
2025-10-31 04:35:26,735 - INFO - Epoch 25/30 - Act Loss: 0.0137, Dom Loss: 1.6286 | Act Acc: 1.0000, Dom Acc: 0.1429 | Val Loss: 0.1833, Val Acc: 0.6964
Epoch 26 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.70it/s, act_loss=0.0316, dom_loss=2.54]
2025-10-31 04:35:29,339 - INFO - Epoch 26/30 - Act Loss: 0.0125, Dom Loss: 1.6410 | Act Acc: 1.0000, Dom Acc: 0.1071 | Val Loss: 0.1843, Val Acc: 0.6964
Epoch 27 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.68it/s, act_loss=0.0399, dom_loss=2.37]
2025-10-31 04:35:31,959 - INFO - Epoch 27/30 - Act Loss: 0.0115, Dom Loss: 1.6125 | Act Acc: 1.0000, Dom Acc: 0.1301 | Val Loss: 0.1856, Val Acc: 0.6875
Epoch 28 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.76it/s, act_loss=0.0213, dom_loss=2.26]
2025-10-31 04:35:34,556 - INFO - Epoch 28/30 - Act Loss: 0.0131, Dom Loss: 1.6427 | Act Acc: 1.0000, Dom Acc: 0.0995 | Val Loss: 0.1882, Val Acc: 0.7054
Epoch 29 (α=1.000): 100%|██████████████████████████████| 25/25 [00:02<00:00, 10.64it/s, act_loss=0.0212, dom_loss=2.45]
2025-10-31 04:35:37,183 - INFO - Epoch 29/30 - Act Loss: 0.0128, Dom Loss: 1.6402 | Act Acc: 1.0000, Dom Acc: 0.1327 | Val Loss: 0.1846, Val Acc: 0.6964
Epoch 30 (α=1.000): 100%|███████████████████████████████| 25/25 [00:02<00:00, 10.71it/s, act_loss=0.049, dom_loss=2.58]
2025-10-31 04:35:39,790 - INFO - Epoch 30/30 - Act Loss: 0.0122, Dom Loss: 1.6242 | Act Acc: 1.0000, Dom Acc: 0.0944 | Val Loss: 0.1869, Val Acc: 0.6875
2025-10-31 04:35:39,791 - INFO - Training complete! Best Val Acc: 0.7054 at epoch 20
2025-10-31 04:35:39,791 - INFO - Evaluating on test set...
2025-10-31 04:35:39,818 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 28.11it/s]
2025-10-31 04:35:39,967 - INFO - ================================================================================
2025-10-31 04:35:39,967 - INFO - Test Results (Adversarial Model)
2025-10-31 04:35:39,967 - INFO - ================================================================================
2025-10-31 04:35:39,968 - INFO - Accuracy:  0.6429
2025-10-31 04:35:39,968 - INFO - Precision: 0.7301
2025-10-31 04:35:39,968 - INFO - Recall:    0.6429
2025-10-31 04:35:39,969 - INFO - F1-Score:  0.6406
2025-10-31 04:35:39,969 - INFO - ================================================================================
2025-10-31 04:35:39,969 - INFO -
Classification Report:
2025-10-31 04:35:39,969 - INFO -
              precision    recall  f1-score   support

         A02     0.8000    1.0000    0.8889         4
         A03     0.8333    1.0000    0.9091         5
         A04     1.0000    0.5000    0.6667         4
         A05     1.0000    0.5000    0.6667         4
         A13     0.6000    0.5000    0.5455         6
         A14     1.0000    0.4000    0.5714         5
         A17     0.5000    1.0000    0.6667         3
         A18     0.3750    0.7500    0.5000         4
         A19     0.6667    0.4000    0.5000         5
         A20     0.3333    0.2500    0.2857         4
         A21     0.5000    1.0000    0.6667         1
         A22     0.2500    1.0000    0.4000         1
         A23     0.7500    0.5000    0.6000         6
         A27     1.0000    1.0000    1.0000         4

    accuracy                         0.6429        56
   macro avg     0.6863    0.7000    0.6334        56
weighted avg     0.7301    0.6429    0.6406        56

2025-10-31 04:35:39,969 - INFO - Results saved to results\adversarial_model\results\adversarial_model_results.json
2025-10-31 04:35:40,509 - INFO - Confusion matrix saved to results\adversarial_model\results\adversarial_model_confusion_matrix.png
2025-10-31 04:35:41,330 - INFO - Training history saved to results\adversarial_model\results\adversarial_model_training_history.png
2025-10-31 04:35:41,330 - INFO - ✓ Adversarial training and evaluation complete!