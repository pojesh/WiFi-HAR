PS C:\Users\Pojesh\Documents\GitHub\WiFi-HAR\ClaudeAdversarial> python train_adversarial.py --epochs 30 --adversarial_lambda 0.05
================================================================================
Configuration Settings
================================================================================

Paths:
  RAW_DATA_ROOT: C:\Users\Pojesh\Documents\project1\working\mmfi\E01
  PROCESSED_DATA_ROOT: data\processed_mmfi_window
  RESULTS_ROOT: results

Dataset:
  NUM_ACTIVITIES: 14
  NUM_SUBJECTS: 10
  WINDOW_SIZE: 64
  STEP_SIZE: 32

Model:
  INPUT_CHANNELS: 3
  GRU_HIDDEN_SIZE: 128
  DROPOUT_RATE: 0.65

Training:
  BATCH_SIZE: 16
  LEARNING_RATE: 0.001
  NUM_EPOCHS: 30

Adversarial:
  ADVERSARIAL_LAMBDA: 0.05
  GRL_ALPHA: 1.0
  PROGRESSIVE_ADVERSARIAL: True

Experiment:
  EXPERIMENT_NAME: wifi_har_adversarial
  EXPERIMENT_MODE: adversarial
  CV_MODE: standard
================================================================================
2025-10-31 14:54:29,404 - INFO - Using device: cuda:0
2025-10-31 14:54:29,407 - INFO - Loading data...
2025-10-31 14:54:29,411 - INFO - Loaded dataset with 1120 samples
2025-10-31 14:54:29,411 - INFO - Data split: Train=784, Val=224, Test=112
2025-10-31 14:54:29,411 - INFO - Creating adversarial model...
2025-10-31 14:54:29,430 - INFO - Initialized CNNGRUBase: Conv2D out=1792, Conv1D in=5376, GRU hidden=128
2025-10-31 14:54:29,431 - INFO - Initialized DomainDiscriminator: input=128, hidden=256, domains=10
2025-10-31 14:54:29,431 - INFO - Initialized AdversarialDANN with GRL
2025-10-31 14:54:29,543 - INFO - Initialized adversarial trainer for adversarial_model
2025-10-31 14:54:29,543 - INFO - Model parameters: 5,204,792
2025-10-31 14:54:29,543 - INFO - Adversarial lambda: 0.05
2025-10-31 14:54:29,543 - INFO - Starting adversarial training...
2025-10-31 14:54:30,752 - INFO - Starting adversarial training for 30 epochs
Epoch 1 (α=0.165): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 12.46it/s, act_loss=2.28, dom_loss=2.06]
2025-10-31 14:54:35,204 - INFO - Epoch 1/30 - Act Loss: 1.7233, Dom Loss: 1.6262 | Act Acc: 0.1543, Dom Acc: 0.1454 | Val Loss: 0.4579, Val Acc: 0.2054
2025-10-31 14:54:35,233 - INFO - ✓ Saved best model (Val Acc: 0.2054)
Epoch 2 (α=0.322): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 15.76it/s, act_loss=1.97, dom_loss=1.87]
2025-10-31 14:54:38,715 - INFO - Epoch 2/30 - Act Loss: 1.4765, Dom Loss: 1.5165 | Act Acc: 0.2462, Dom Acc: 0.2245 | Val Loss: 0.3643, Val Acc: 0.4241
2025-10-31 14:54:38,738 - INFO - ✓ Saved best model (Val Acc: 0.4241)
Epoch 3 (α=0.462): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 15.76it/s, act_loss=1.96, dom_loss=2.25]
2025-10-31 14:54:42,219 - INFO - Epoch 3/30 - Act Loss: 1.2416, Dom Loss: 1.4905 | Act Acc: 0.3814, Dom Acc: 0.2436 | Val Loss: 0.3290, Val Acc: 0.4107
Epoch 4 (α=0.583): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 15.60it/s, act_loss=1.28, dom_loss=2.23]
2025-10-31 14:54:45,728 - INFO - Epoch 4/30 - Act Loss: 1.0527, Dom Loss: 1.5075 | Act Acc: 0.4745, Dom Acc: 0.2270 | Val Loss: 0.2658, Val Acc: 0.5268
2025-10-31 14:54:45,751 - INFO - ✓ Saved best model (Val Acc: 0.5268)
Epoch 5 (α=0.682): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 15.67it/s, act_loss=1.68, dom_loss=2.34]
2025-10-31 14:54:49,241 - INFO - Epoch 5/30 - Act Loss: 0.8172, Dom Loss: 1.5970 | Act Acc: 0.6122, Dom Acc: 0.1684 | Val Loss: 0.2283, Val Acc: 0.6295
2025-10-31 14:54:49,266 - INFO - ✓ Saved best model (Val Acc: 0.6295)
Epoch 6 (α=0.762): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 15.76it/s, act_loss=1.19, dom_loss=2.42]
2025-10-31 14:54:52,745 - INFO - Epoch 6/30 - Act Loss: 0.6651, Dom Loss: 1.5513 | Act Acc: 0.6671, Dom Acc: 0.1671 | Val Loss: 0.2336, Val Acc: 0.5759
Epoch 7 (α=0.823): 100%|█████████████████████████████████| 49/49 [00:03<00:00, 15.72it/s, act_loss=1.01, dom_loss=2.17]
2025-10-31 14:54:56,230 - INFO - Epoch 7/30 - Act Loss: 0.5887, Dom Loss: 1.5727 | Act Acc: 0.7360, Dom Acc: 0.1620 | Val Loss: 0.1495, Val Acc: 0.7321
2025-10-31 14:54:56,255 - INFO - ✓ Saved best model (Val Acc: 0.7321)
Epoch 8 (α=0.870): 100%|████████████████████████████████| 49/49 [00:03<00:00, 15.78it/s, act_loss=0.474, dom_loss=2.25]
2025-10-31 14:54:59,739 - INFO - Epoch 8/30 - Act Loss: 0.4588, Dom Loss: 1.5658 | Act Acc: 0.7985, Dom Acc: 0.1798 | Val Loss: 0.1011, Val Acc: 0.8304
2025-10-31 14:54:59,762 - INFO - ✓ Saved best model (Val Acc: 0.8304)
Epoch 9 (α=0.905): 100%|████████████████████████████████| 49/49 [00:03<00:00, 15.77it/s, act_loss=0.475, dom_loss=2.53]
2025-10-31 14:55:03,238 - INFO - Epoch 9/30 - Act Loss: 0.3349, Dom Loss: 1.5871 | Act Acc: 0.8661, Dom Acc: 0.1696 | Val Loss: 0.1241, Val Acc: 0.7902
Epoch 10 (α=0.931): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.80it/s, act_loss=0.266, dom_loss=2.46]
2025-10-31 14:55:06,728 - INFO - Epoch 10/30 - Act Loss: 0.2446, Dom Loss: 1.6058 | Act Acc: 0.9209, Dom Acc: 0.1582 | Val Loss: 0.0885, Val Acc: 0.8482
2025-10-31 14:55:06,756 - INFO - ✓ Saved best model (Val Acc: 0.8482)
Epoch 11 (α=0.950): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.76it/s, act_loss=0.229, dom_loss=2.34]
2025-10-31 14:55:10,247 - INFO - Epoch 11/30 - Act Loss: 0.2777, Dom Loss: 1.6039 | Act Acc: 0.8865, Dom Acc: 0.1620 | Val Loss: 0.1930, Val Acc: 0.6652
Epoch 12 (α=0.964): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.79it/s, act_loss=0.351, dom_loss=2.24]
2025-10-31 14:55:13,723 - INFO - Epoch 12/30 - Act Loss: 0.1881, Dom Loss: 1.6112 | Act Acc: 0.9349, Dom Acc: 0.1518 | Val Loss: 0.0926, Val Acc: 0.8482
Epoch 13 (α=0.974): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.81it/s, act_loss=0.535, dom_loss=2.21]
2025-10-31 14:55:17,189 - INFO - Epoch 13/30 - Act Loss: 0.1800, Dom Loss: 1.5980 | Act Acc: 0.9362, Dom Acc: 0.1543 | Val Loss: 0.0792, Val Acc: 0.8705
2025-10-31 14:55:17,214 - INFO - ✓ Saved best model (Val Acc: 0.8705)
Epoch 14 (α=0.981): 100%|████████████████████████████████| 49/49 [00:03<00:00, 15.79it/s, act_loss=0.235, dom_loss=2.1]
2025-10-31 14:55:20,691 - INFO - Epoch 14/30 - Act Loss: 0.1107, Dom Loss: 1.5803 | Act Acc: 0.9630, Dom Acc: 0.1633 | Val Loss: 0.0617, Val Acc: 0.8929
2025-10-31 14:55:20,718 - INFO - ✓ Saved best model (Val Acc: 0.8929)
Epoch 15 (α=0.987): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.79it/s, act_loss=0.231, dom_loss=2.23]
2025-10-31 14:55:24,195 - INFO - Epoch 15/30 - Act Loss: 0.1002, Dom Loss: 1.6002 | Act Acc: 0.9694, Dom Acc: 0.1339 | Val Loss: 0.0541, Val Acc: 0.9018
2025-10-31 14:55:24,220 - INFO - ✓ Saved best model (Val Acc: 0.9018)
Epoch 16 (α=0.990): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.76it/s, act_loss=0.0654, dom_loss=2.23]
2025-10-31 14:55:27,696 - INFO - Epoch 16/30 - Act Loss: 0.0835, Dom Loss: 1.5924 | Act Acc: 0.9821, Dom Acc: 0.1620 | Val Loss: 0.2391, Val Acc: 0.6652
Epoch 17 (α=0.993): 100%|████████████████████████████████| 49/49 [00:03<00:00, 15.76it/s, act_loss=0.03, dom_loss=2.32]
2025-10-31 14:55:31,183 - INFO - Epoch 17/30 - Act Loss: 0.0953, Dom Loss: 1.5895 | Act Acc: 0.9668, Dom Acc: 0.1556 | Val Loss: 0.0889, Val Acc: 0.8571
Epoch 18 (α=0.995): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.77it/s, act_loss=0.0508, dom_loss=2.11]
2025-10-31 14:55:34,665 - INFO - Epoch 18/30 - Act Loss: 0.0938, Dom Loss: 1.5918 | Act Acc: 0.9668, Dom Acc: 0.1607 | Val Loss: 0.0552, Val Acc: 0.9062
2025-10-31 14:55:34,690 - INFO - ✓ Saved best model (Val Acc: 0.9062)
Epoch 19 (α=0.996): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.72it/s, act_loss=0.493, dom_loss=2.31]
2025-10-31 14:55:38,186 - INFO - Epoch 19/30 - Act Loss: 0.0871, Dom Loss: 1.5872 | Act Acc: 0.9732, Dom Acc: 0.1594 | Val Loss: 0.2096, Val Acc: 0.7321
Epoch 20 (α=0.997): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.77it/s, act_loss=0.0476, dom_loss=2.11]
2025-10-31 14:55:41,660 - INFO - Epoch 20/30 - Act Loss: 0.0791, Dom Loss: 1.5966 | Act Acc: 0.9745, Dom Acc: 0.1212 | Val Loss: 0.0764, Val Acc: 0.8884
Epoch 21 (α=0.998): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.85it/s, act_loss=0.237, dom_loss=2.28]
2025-10-31 14:55:45,127 - INFO - Epoch 21/30 - Act Loss: 0.0747, Dom Loss: 1.5998 | Act Acc: 0.9707, Dom Acc: 0.1416 | Val Loss: 0.0898, Val Acc: 0.8348
Epoch 22 (α=0.999): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.78it/s, act_loss=0.115, dom_loss=2.27]
2025-10-31 14:55:48,611 - INFO - Epoch 22/30 - Act Loss: 0.1090, Dom Loss: 1.6063 | Act Acc: 0.9579, Dom Acc: 0.1339 | Val Loss: 0.0630, Val Acc: 0.9107
2025-10-31 14:55:48,637 - INFO - ✓ Saved best model (Val Acc: 0.9107)
Epoch 23 (α=0.999): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.85it/s, act_loss=0.0813, dom_loss=2.16]
2025-10-31 14:55:52,105 - INFO - Epoch 23/30 - Act Loss: 0.1195, Dom Loss: 1.5905 | Act Acc: 0.9503, Dom Acc: 0.1492 | Val Loss: 0.0679, Val Acc: 0.8884
Epoch 24 (α=0.999): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.81it/s, act_loss=0.0519, dom_loss=2.28]
2025-10-31 14:55:55,573 - INFO - Epoch 24/30 - Act Loss: 0.0646, Dom Loss: 1.5857 | Act Acc: 0.9770, Dom Acc: 0.1314 | Val Loss: 0.0728, Val Acc: 0.8973
Epoch 25 (α=1.000): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.78it/s, act_loss=0.0157, dom_loss=2.1]
2025-10-31 14:55:59,047 - INFO - Epoch 25/30 - Act Loss: 0.0603, Dom Loss: 1.5825 | Act Acc: 0.9783, Dom Acc: 0.1798 | Val Loss: 0.0591, Val Acc: 0.9018
Epoch 26 (α=1.000): 100%|███████████████████████████████| 49/49 [00:03<00:00, 15.83it/s, act_loss=0.172, dom_loss=2.24]
2025-10-31 14:56:02,522 - INFO - Epoch 26/30 - Act Loss: 0.0603, Dom Loss: 1.5755 | Act Acc: 0.9770, Dom Acc: 0.1518 | Val Loss: 0.0673, Val Acc: 0.8973
Epoch 27 (α=1.000): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.85it/s, act_loss=0.0315, dom_loss=2.18]
2025-10-31 14:56:05,984 - INFO - Epoch 27/30 - Act Loss: 0.0328, Dom Loss: 1.5863 | Act Acc: 0.9898, Dom Acc: 0.1556 | Val Loss: 0.0250, Val Acc: 0.9554
2025-10-31 14:56:06,009 - INFO - ✓ Saved best model (Val Acc: 0.9554)
Epoch 28 (α=1.000): 100%|████████████████████████████████| 49/49 [00:03<00:00, 15.72it/s, act_loss=0.13, dom_loss=2.36]
2025-10-31 14:56:09,501 - INFO - Epoch 28/30 - Act Loss: 0.0135, Dom Loss: 1.5835 | Act Acc: 0.9974, Dom Acc: 0.1607 | Val Loss: 0.0273, Val Acc: 0.9464
Epoch 29 (α=1.000): 100%|██████████████████████████████| 49/49 [00:03<00:00, 15.79it/s, act_loss=0.0059, dom_loss=2.27]
2025-10-31 14:56:12,984 - INFO - Epoch 29/30 - Act Loss: 0.0106, Dom Loss: 1.5858 | Act Acc: 0.9987, Dom Acc: 0.1480 | Val Loss: 0.0309, Val Acc: 0.9509
Epoch 30 (α=1.000): 100%|█████████████████████████████| 49/49 [00:03<00:00, 15.80it/s, act_loss=0.00756, dom_loss=2.19]
2025-10-31 14:56:16,459 - INFO - Epoch 30/30 - Act Loss: 0.0214, Dom Loss: 1.5926 | Act Acc: 0.9936, Dom Acc: 0.1378 | Val Loss: 0.0305, Val Acc: 0.9554
2025-10-31 14:56:16,460 - INFO - Training complete! Best Val Acc: 0.9554 at epoch 27
2025-10-31 14:56:16,460 - INFO - Evaluating on test set...
2025-10-31 14:56:16,487 - INFO - Loaded best model for evaluation
Testing: 100%|███████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 27.21it/s]
2025-10-31 14:56:16,751 - INFO - ================================================================================
2025-10-31 14:56:16,751 - INFO - Test Results (Adversarial Model)
2025-10-31 14:56:16,752 - INFO - ================================================================================
2025-10-31 14:56:16,752 - INFO - Accuracy:  0.9375
2025-10-31 14:56:16,752 - INFO - Precision: 0.9426
2025-10-31 14:56:16,752 - INFO - Recall:    0.9375
2025-10-31 14:56:16,752 - INFO - F1-Score:  0.9378
2025-10-31 14:56:16,752 - INFO - ================================================================================
2025-10-31 14:56:16,752 - INFO -
Classification Report:
2025-10-31 14:56:16,752 - INFO -
              precision    recall  f1-score   support

         A02     1.0000    1.0000    1.0000         6
         A03     1.0000    1.0000    1.0000         3
         A04     1.0000    1.0000    1.0000         6
         A05     1.0000    1.0000    1.0000         8
         A13     1.0000    1.0000    1.0000         5
         A14     1.0000    1.0000    1.0000         8
         A17     0.8571    1.0000    0.9231         6
         A18     1.0000    0.8889    0.9412         9
         A19     1.0000    1.0000    1.0000         7
         A20     0.8333    1.0000    0.9091         5
         A21     1.0000    0.9167    0.9565        12
         A22     0.7273    0.8889    0.8000         9
         A23     0.8571    0.7500    0.8000        16
         A27     1.0000    1.0000    1.0000        12

    accuracy                         0.9375       112
   macro avg     0.9482    0.9603    0.9521       112
weighted avg     0.9426    0.9375    0.9378       112

2025-10-31 14:56:16,753 - INFO - Results saved to results\adversarial_model\results\adversarial_model_results.json
2025-10-31 14:56:17,432 - INFO - Confusion matrix saved to results\adversarial_model\results\adversarial_model_confusion_matrix.png
2025-10-31 14:56:18,182 - INFO - Training history saved to results\adversarial_model\results\adversarial_model_training_history.png
2025-10-31 14:56:18,182 - INFO - ✓ Adversarial training and evaluation complete!